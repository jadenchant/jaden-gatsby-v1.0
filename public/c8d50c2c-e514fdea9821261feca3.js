(self.webpackChunkjaden_v1_0=self.webpackChunkjaden_v1_0||[]).push([[27],{8161:function(e,t,n){!function(e){"use strict";try{(function(){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){return new(n=n||Promise)((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,(s=i?[2&s[0],i.value]:s)[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function h(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function c(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t}function d(e){try{return y.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}var p={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},f=function(e,t){if(!e)throw _(t)},_=function(e){return new Error("Firebase Database ("+p.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},y={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,a=s?e[i+1]:0,u=i+2<e.length,l=o>>2,h=(o=(3&o)<<4|a>>4,a=(15&a)<<2|(h=u?e[i+2]:0)>>6,63&h);u||(h=64,s||(a=64)),r.push(n[l],n[o],n[a],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(c(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i,o,s,a=e[n++];a<128?t[r++]=String.fromCharCode(a):191<a&&a<224?(o=e[n++],t[r++]=String.fromCharCode((31&a)<<6|63&o)):239<a&&a<365?(i=((7&a)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))):(o=e[n++],s=e[n++],t[r++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();o=o<<2|s>>4,r.push(o),64!==a&&(s=s<<4&240|a>>2,r.push(s),64!==u&&(u|=a<<6&192,r.push(u)))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};function v(e){return function e(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(var r in n)n.hasOwnProperty(r)&&g(r)&&(t[r]=e(t[r],n[r]));return t}(void 0,e)}function g(e){return"__proto__"!==e}var m=(w.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},w);function w(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}function C(){return"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function b(){return!0===p.NODE_ADMIN}var E,I="FirebaseError",S=(i(T,E=Error),T);function T(e,t,n){return(t=E.call(this,t)||this).code=e,t.customData=n,t.name=I,Object.setPrototypeOf(t,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,P.prototype.create),t}var P=(N.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e;return e=(e=this.errors[e])?(r=i,e.replace(R,(function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"}))):"Error",e=this.serviceName+": "+e+" ("+o+").",new S(o,e,i)},N);function N(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var R=/\{\$([^}]+)}/g;function x(e){return JSON.parse(e)}function k(e){return JSON.stringify(e)}function D(e){var t={},n={},r={},i="";try{var o=e.split(".");t=x(d(o[0])||""),n=x(d(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function A(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function L(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function M(e,t,n){var r,i={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function F(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var i=r[n];!function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}(i[0],i[1])}return t.length?"&"+t.join("&"):""}var q=(W.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},W.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){var c=r<40?r<20?(o=l^a&(u^l),1518500249):(o=a^u^l,1859775393):r<60?(o=a&u|l&(a|u),2400959708):(o=a^u^l,3395469782);i=(s<<5|s>>>27)+o+h+c+n[r]&4294967295,h=l,l=u,u=4294967295&(a<<30|a>>>2),a=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},W.prototype.update=function(e,t){if(null!=e){for(var n=(t=void 0===t?e.length:t)-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},W.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},W);function W(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}function Q(e,t,n,r){var i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function j(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return(e+=" failed: ")+r+" argument "}function U(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(j(e,t,r)+"must be a valid function.")}function B(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(j(e,t,r)+"must be a valid context object.")}function H(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?(t+=4,n++):t+=3}return t}var V=(z.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},z.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},z.prototype.setServiceProps=function(e){return this.serviceProps=e,this},z.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},z);function z(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var K="[DEFAULT]",Y=(G.prototype.get=function(e){void 0===e&&(e=K);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new m;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},G.prototype.getImmediate=function(e){e=(t=o({identifier:K,optional:!1},e)).identifier;var t=t.optional,n=this.normalizeInstanceIdentifier(e);if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(t)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(t)return null;throw e}},G.prototype.getComponent=function(){return this.component},G.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:K})}catch(e){}try{for(var r=u(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=l(i.value,2),s=o[0],a=o[1],h=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:h});a.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},G.prototype.clearInstance=function(e){void 0===e&&(e=K),this.instancesDeferred.delete(e),this.instances.delete(e)},G.prototype.delete=function(){return s(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(h(h([],l(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),l(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},G.prototype.isComponentSet=function(){return null!=this.component},G.prototype.isInitialized=function(e){return void 0===e&&(e=K),this.instances.has(e)},G.prototype.initialize=function(e){var t,n,r=void 0===(r=(e=void 0===e?{}:e).instanceIdentifier)?K:r,i=(e=void 0===(e=e.options)?{}:e,this.normalizeInstanceIdentifier(r));if(this.isInitialized(i))throw Error(this.name+"("+i+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:i,options:e});try{for(var s=u(this.instancesDeferred.entries()),a=s.next();!a.done;a=s.next()){var h=(c=l(a.value,2))[0],c=c[1];i===this.normalizeInstanceIdentifier(h)&&c.resolve(o)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},G.prototype.getOrInitializeService=function(e){var t=e.instanceIdentifier,n=e.options,r=(e=void 0===n?{}:n,this.instances.get(t));if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t)===K?void 0:n,options:e}),this.instances.set(t,r),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(e){}return r||null},G.prototype.normalizeInstanceIdentifier=function(e){return!this.component||this.component.multipleInstances?e:K},G.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},G);function G(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var $,J=(X.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},X.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},X.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Y(e,this);return this.providers.set(e,t),t},X.prototype.getProviders=function(){return Array.from(this.providers.values())},X);function X(e){this.name=e,this.providers=new Map}function Z(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=ne[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,h(["["+i+"]  "+e.name+":"],n))}}(mt=$=$||{})[mt.DEBUG=0]="DEBUG",mt[mt.VERBOSE=1]="VERBOSE",mt[mt.INFO=2]="INFO",mt[mt.WARN=3]="WARN",mt[mt.ERROR=4]="ERROR",mt[mt.SILENT=5]="SILENT";var ee={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},te=$.INFO,ne=((Ct={})[$.DEBUG]="log",Ct[$.VERBOSE]="log",Ct[$.INFO]="info",Ct[$.WARN]="warn",Ct[$.ERROR]="error",Ct),re=(Object.defineProperty(ie.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in $))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),ie.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?ee[e]:e},Object.defineProperty(ie.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),ie.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,h([this,$.DEBUG],e)),this._logHandler.apply(this,h([this,$.DEBUG],e))},ie.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,h([this,$.VERBOSE],e)),this._logHandler.apply(this,h([this,$.VERBOSE],e))},ie.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,h([this,$.INFO],e)),this._logHandler.apply(this,h([this,$.INFO],e))},ie.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,h([this,$.WARN],e)),this._logHandler.apply(this,h([this,$.WARN],e))},ie.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,h([this,$.ERROR],e)),this._logHandler.apply(this,h([this,$.ERROR],e))},ie);function ie(e){this.name=e,this._logLevel=te,this._logHandler=Z,this._userLogHandler=null}var oe=(se.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),k(t))},se.prototype.get=function(e){return null==(e=this.domStorage_.getItem(this.prefixedName_(e)))?null:x(e)},se.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},se.prototype.prefixedName_=function(e){return this.prefix_+e},se.prototype.toString=function(){return this.domStorage_.toString()},se);function se(e){this.domStorage_=e,this.prefix_="firebase:"}var ae=(ue.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},ue.prototype.get=function(e){return O(this.cache_,e)?this.cache_[e]:null},ue.prototype.remove=function(e){delete this.cache_[e]},ue);function ue(){this.cache_={},this.isInMemoryStorage=!0}function le(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i,o=e.charCodeAt(r);55296<=o&&o<=56319&&(i=o-55296,f(++r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(i<<10)+(e.charCodeAt(r)-56320)),o<128?t[n++]=o:(o<2048?t[n++]=o>>6|192:(o<65536?t[n++]=o>>12|224:(t[n++]=o>>18|240,t[n++]=o>>12&63|128),t[n++]=o>>6&63|128),t[n++]=63&o|128)}return t}(e);return(e=new q).update(t),e=e.digest(),y.encodeByteArray(e)}function he(e,t){f(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(me.logLevel=$.VERBOSE,be=me.log.bind(me),t&&ge.set("logging_enabled",!0)):"function"==typeof e?be=e:(be=null,ge.remove("logging_enabled"))}function ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+Ce.apply(void 0,h([],l(e)));me.error(n)}function de(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}function pe(e,t){return e===t?0:e<t?-1:1}function fe(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+k(t))}function _e(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)n<i+t?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r}var ye,ve=(on=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new oe(t)}}catch(e){}return new ae})("localStorage"),ge=on("sessionStorage"),me=new re("@firebase/database"),we=(ye=1,function(){return ye++}),Ce=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var o=t[i];Array.isArray(o)||o&&"object"==typeof o&&"number"==typeof o.length?r+=e.apply(null,o):r+="object"==typeof o?k(o):o,r+=" "}return r},be=null,Ee=!0,Ie=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];!0===Ee&&(Ee=!1,null===be&&!0===ge.get("logging_enabled")&&he(!0)),be&&(e=Ce.apply(null,t),be(e))},Se=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Ie.apply(void 0,h([e],l(t)))}},Te=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+Ce.apply(void 0,h([],l(e)));throw me.error(n),new Error(n)},Pe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+Ce.apply(void 0,h([],l(e)));me.warn(n)},Ne="[MIN_NAME]",Re="[MAX_NAME]",xe=function(e,t){if(e===t)return 0;if(e===Ne||t===Re)return-1;if(t===Ne||e===Re)return 1;var n=We(e),r=We(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1},ke=function e(t){if("object"!=typeof t||null===t)return k(t);var n,r=[];for(n in t)r.push(n);r.sort();for(var i="{",o=0;o<r.length;o++)0!==o&&(i+=","),i+=k(r[o]),i+=":",i+=e(t[r[o]]);return i+"}"};function De(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function Oe(e){var t,n,r,i;f(!de(e),"Invalid JSON number"),0===e?t=1/e==-1/(r=n=0)?1:0:(t=e<0,r=(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(e/Math.pow(2,-1074))));for(var o=[],s=52;s;--s)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;--s)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();var a=o.join(""),u="";for(s=0;s<64;s+=8){var l=parseInt(a.substr(s,8),2).toString(16);u+=l=1===l.length?"0"+l:l}return u.toLowerCase()}function Ae(e,t){return"object"==typeof(t=setTimeout(e,t))&&t.unref&&t.unref(),t}var Le=function(e,t){var n="Unknown Error";return"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable"),(n=new Error(e+" at "+t.path.toString()+": "+n)).code=e.toUpperCase(),n},Me=new RegExp("^-?(0*)\\d{1,10}$"),Fe=-2147483648,qe=2147483647,We=function(e){return Me.test(e)&&(e=Number(e),Fe<=e&&e<=qe)?e:null},Qe=function(e){try{e()}catch(n){setTimeout((function(){var t=n.stack||"";throw Pe("Exception was thrown by user callback.",t),n}),Math.floor(0))}},je=(Ue.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(Ie("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):Promise.resolve(null)},Ue.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout((function(){return e(null)}),0),this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)})))},Ue.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},Ue.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Pe(e)},Ue);function Ue(e,t){var n=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then((function(e){return n.auth_=e}))}var Be=(He.prototype.getToken=function(e){return Promise.resolve({accessToken:He.EMULATOR_AUTH_TOKEN})},He.prototype.addTokenChangeListener=function(e){e(He.EMULATOR_AUTH_TOKEN)},He.prototype.removeTokenChangeListener=function(e){},He.prototype.notifyForInvalidToken=function(){},He.EMULATOR_AUTH_TOKEN="owner",He);function He(){}var Ve=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ze="websocket",Ke="long_polling",Ye=(Ge.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},Ge.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(Ge.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ve.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),Ge.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},Ge.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return e+this.host+"/"+t},Ge);function Ge(e,t,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ve.get("host:"+e)||this._host}function $e(e,t,n){var r;if(f("string"==typeof t,"typeof type must == string"),f("object"==typeof n,"typeof params must == object"),t===ze)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Ke)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}((t=e).host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams)&&(n.ns=e.namespace);var i=[];return De(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var Je=(Xe.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),O(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},Xe.prototype.get=function(){return v(this.counters_)},Xe);function Xe(){this.counters_={}}var Ze={},et={};function tt(e){return e=e.toString(),Ze[e]||(Ze[e]=new Je),Ze[e]}var nt=(rt.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},rt.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var e=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var t=0;t<e.length;++t)!function(t){e[t]&&Qe((function(){n.onMessage_(e[t])}))}(t);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}(););},rt);function rt(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}var it="pLPCommand",ot="pRTLPCB",st=(at.prototype.open=function(e,t){var n,r,i,o=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new nt(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){o.log_("Timed out trying to connect."),o.onClosed_(),o.connectTimeoutTimer_=null}),Math.floor(3e4)),n=function(){var e;o.isClosed_||(o.scriptTagHolder=new ut((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=l(e,5),r=n[0],i=n[1],s=n[2];if(n[3],n[4],o.incrementIncomingBytes_(e),o.scriptTagHolder)if(o.connectTimeoutTimer_&&(clearTimeout(o.connectTimeoutTimer_),o.connectTimeoutTimer_=null),o.everConnected_=!0,"start"===r)o.id=i,o.password=s;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(o.scriptTagHolder.sendNewPolls=!1,o.myPacketOrderer.closeAfter(i,(function(){o.onClosed_()}))):o.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(r=l(e,2))[0],r=r[1];o.incrementIncomingBytes_(e),o.myPacketOrderer.handleResponse(n,r)}),(function(){o.onClosed_()}),o.urlFn),(e={start:"t"}).ser=Math.floor(1e8*Math.random()),o.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=o.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",o.transportSessionId&&(e.s=o.transportSessionId),o.lastSessionId&&(e.ls=o.lastSessionId),o.applicationId&&(e.p=o.applicationId),"undefined"!=typeof location&&location.hostname&&Ve.test(location.hostname)&&(e.r="f"),e=o.urlFn(e),o.log_("Connecting via long-poll to "+e),o.scriptTagHolder.addTag(e,(function(){})))},"complete"===document.readyState?n():(r=!1,i=function(){document.body?r||(r=!0,n()):setTimeout(i,Math.floor(10))},document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&i()})),window.attachEvent("onload",i)))},at.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},at.forceAllow=function(){at.forceAllow_=!0},at.forceDisallow=function(){at.forceDisallow_=!0},at.isAvailable=function(){return!!at.forceAllow_||!(at.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},at.prototype.markConnectionHealthy=function(){},at.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},at.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},at.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},at.prototype.send=function(e){e=k(e),this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var t=_e(e=function(e){return e=c(e),y.encodeByteArray(e,!0)}(e),1840),n=0;n<t.length;n++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,t.length,t[n]),this.curSegmentNum++},at.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},at.prototype.incrementIncomingBytes_=function(e){e=k(e).length,this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},at);function at(e,t,n,r,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Se(e),this.stats_=tt(t),this.urlFn=function(e){return $e(t,Ke,e)}}var ut=(lt.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ie("No IE domain setting required")}catch(t){var n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},lt.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},lt.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},lt.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++,(e={}).id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var e=this.urlFn(e),t="",n=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+t.length<=1870;){var r=this.pendingSegs.shift();t=t+"&seg"+n+"="+r.seg+"&ts"+n+"="+r.ts+"&d"+n+"="+r.d,n++}return e+=t,this.addLongPollTag_(e,this.currentSerial),!0}return!1},lt.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},lt.prototype.addLongPollTag_=function(e,t){var n=this;function r(){n.outstandingRequests.delete(t),n.newRequest_()}this.outstandingRequests.add(t);var i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))},lt.prototype.addTag=function(e,t){var n=this;setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){Ie("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(e){}}),Math.floor(1))},lt);function lt(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=we(),window[it+this.uniqueCallbackIdentifier]=e,window[ot+this.uniqueCallbackIdentifier]=t,this.myIFrame=lt.createIFrame_(),t="";var i="<html><body>"+(t=this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)?'<script>document.domain="'+document.domain+'";<\/script>':t)+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){Ie("frame writing exception"),e.stack&&Ie(e.stack),Ie(e)}}var ht="";function ct(e){ht=e}var dt=null;"undefined"!=typeof MozWebSocket?dt=MozWebSocket:"undefined"!=typeof WebSocket&&(dt=WebSocket);var pt=(ft.connectionURL_=function(e,t,n){var r={v:"5"};return"undefined"!=typeof location&&location.hostname&&Ve.test(location.hostname)&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),$e(e,ze,r)},ft.prototype.open=function(e,t){var n,r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ve.set("previous_websocket_failure",!0);try{b()||(n={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new dt(this.connURL,[],n))}catch(t){return this.log_("Error instantiating WebSocket."),(e=t.message||t.data)&&this.log_(e),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection."),(e=e.message||e.data)&&r.log_(e),r.onClosed_()}},ft.prototype.start=function(){},ft.forceDisallow=function(){ft.forceDisallow_=!0},ft.isAvailable=function(){var e,t=!1;return"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/))&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0),!t&&null!==dt&&!ft.forceDisallow_},ft.previouslyFailed=function(){return ve.isInMemoryStorage||!0===ve.get("previous_websocket_failure")},ft.prototype.markConnectionHealthy=function(){ve.remove("previous_websocket_failure")},ft.prototype.appendFrame_=function(e){this.frames.push(e),this.frames.length===this.totalFrames&&(e=this.frames.join(""),this.frames=null,e=x(e),this.onMessage(e))},ft.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},ft.prototype.extractFrameCount_=function(e){if(f(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},ft.prototype.handleIncomingFrame=function(e){null!==this.mySock&&(e=e.data,this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),(null!==this.frames||null!==(e=this.extractFrameCount_(e)))&&this.appendFrame_(e))},ft.prototype.send=function(e){this.resetKeepAlive(),e=k(e),this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var t=_e(e,16384);1<t.length&&this.sendString_(String(t.length));for(var n=0;n<t.length;n++)this.sendString_(t[n])},ft.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},ft.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},ft.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},ft.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))},ft.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},ft.responsesRequiredToBeHealthy=2,ft.healthyTimeout=3e4,ft);function ft(e,t,n,r,i){this.connId=e,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Se(this.connId),this.stats_=tt(t),this.connURL=ft.connectionURL_(t,r,i),this.nodeAdmin=t.nodeAdmin}var _t=(Object.defineProperty(yt,"ALL_TRANSPORTS",{get:function(){return[st,pt]},enumerable:!1,configurable:!0}),yt.prototype.initTransports_=function(e){var t,n,r=pt&&pt.isAvailable(),i=r&&!pt.previouslyFailed();if(e.webSocketOnly&&(r||Pe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[pt];else{var o=this.transports_=[];try{for(var s=u(yt.ALL_TRANSPORTS),a=s.next();!a.done;a=s.next()){var l=a.value;l&&l.isAvailable()&&o.push(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}},yt.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},yt.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},yt);function yt(e){this.initTransports_(e)}var vt=(gt.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0)),0<(t=t.healthyTimeout||0)&&(this.healthyTimeout_=Ae((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&102400<e.conn_.bytesReceived?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&10240<e.conn_.bytesSent?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(t)))},gt.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},gt.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},gt.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},gt.prototype.sendRequest=function(e){e={t:"d",d:e},this.sendData_(e)},gt.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},gt.prototype.onSecondaryControl_=function(e){"t"in e&&("a"===(e=e.t)?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_()))},gt.prototype.onSecondaryMessageReceived_=function(e){var t=fe("t",e);if(e=fe("d",e),"c"===t)this.onSecondaryControl_(e);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(e)}},gt.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},gt.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},gt.prototype.onPrimaryMessageReceived_=function(e){var t=fe("t",e);e=fe("d",e),"c"===t?this.onControl_(e):"d"===t&&this.onDataMessage_(e)},gt.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},gt.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},gt.prototype.onControl_=function(e){var t=fe("t",e);if("d"in e)if(e=e.d,"h"===t)this.onHandshake_(e);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(e):"r"===t?this.onReset_(e):"e"===t?ce("Server Error: "+e):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ce("Unknown control packet command: "+t)},gt.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Pe("Protocol version mismatch detected"),this.tryStartUpgrade_())},gt.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},gt.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_);e=this.disconnReceiver_(this.secondaryConn_),this.secondaryConn_.open(n,e),Ae((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))},gt.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},gt.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ae((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},gt.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},gt.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},gt.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ve.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},gt.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},gt.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},gt.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},gt.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},gt);function gt(e,t,n,r,i,o,s,a){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Se("c:"+this.id+":"),this.transportManager_=new _t(t),this.log_("Connection created"),this.start_()}var mt=(wt.prototype.put=function(e,t,n,r){},wt.prototype.merge=function(e,t,n,r){},wt.prototype.refreshAuthToken=function(e){},wt.prototype.onDisconnectPut=function(e,t,n){},wt.prototype.onDisconnectMerge=function(e,t,n){},wt.prototype.onDisconnectCancel=function(e,t){},wt.prototype.reportStats=function(e){},wt);function wt(){}var Ct=(bt.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=h([],l(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},bt.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n}),(e=this.getInitialEvent(e))&&t.apply(n,e)},bt.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},bt.prototype.validateEventType_=function(e){f(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},bt);function bt(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}var Et,It=(i(St,Et=Ct),St.getInstance=function(){return new St},St.prototype.getInitialEvent=function(e){return f("online"===e,"Unknown event type: "+e),[this.online_]},St.prototype.currentlyOnline=function(){return this.online_},St);function St(){var e=Et.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||C()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}var Tt=32,Pt=768,Nt=(Rt.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},Rt);function Rt(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}function xt(){return new Nt("")}function kt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Dt(e){return e.pieces_.length-e.pieceNum_}function Ot(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new Nt(e.pieces_,t)}function At(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Lt(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function Mt(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Nt(t,0)}function Ft(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Nt)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)0<i[r].length&&n.push(i[r])}return new Nt(n,0)}function qt(e){return e.pieceNum_>=e.pieces_.length}function Wt(e,t){var n=kt(e),r=kt(t);if(null===n)return t;if(n===r)return Wt(Ot(e),Ot(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Qt(e,t){for(var n=Lt(e,0),r=Lt(t,0),i=0;i<n.length&&i<r.length;i++){var o=xe(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function jt(e,t){if(Dt(e)!==Dt(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ut(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Dt(e)>Dt(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Bt=function(e,t){this.errorPrefix_=t,this.parts_=Lt(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=H(this.parts_[n]);Ht(this)};function Ht(e){if(e.byteLength_>Pt)throw new Error(e.errorPrefix_+"has a key path longer than "+Pt+" bytes ("+e.byteLength_+").");if(e.parts_.length>Tt)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Tt+") or object contains a cycle "+Vt(e))}function Vt(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var zt,Kt=(i(Yt,zt=Ct),Yt.getInstance=function(){return new Yt},Yt.prototype.getInitialEvent=function(e){return f("visible"===e,"Unknown event type: "+e),[this.visible_]},Yt);function Yt(){var e,t,n=zt.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),n.visible_=!0,t&&document.addEventListener(t,(function(){var t=!document[e];t!==n.visible_&&(n.visible_=t,n.trigger("visible",t))}),!1),n}var Gt,$t=1e3,Jt=3e5,Xt=(i(Zt,Gt=mt),Zt.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_;t={r:r,a:e,b:t},this.log_(k(t)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(t),n&&(this.requestCBHash_[r]=n)},Zt.prototype.get=function(e){var t=this,n=new m,r={p:e.path.toString(),q:e.queryObject()},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise},Zt.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),f(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(o).has(i),"listen() called twice for same path/queryId."),n={onComplete:r,hashFn:t,query:e,tag:n},this.listens.get(o).set(i,n),this.connected_&&this.sendListen_(n)},Zt.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},Zt.prototype.sendListen_=function(e){var t=this,n=e.query,r=n.path.toString(),i=n.queryIdentifier();this.log_("Listen on "+r+" for "+i);var o={p:r};e.tag&&(o.q=n.queryObject(),o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var s=o.d,a=o.s;Zt.warnOnListenWarnings_(s,n),(t.listens.get(r)&&t.listens.get(r).get(i))===e&&(t.log_("listen response",o),"ok"!==a&&t.removeListen_(r,i),e.onComplete&&e.onComplete(a,s))}))},Zt.warnOnListenWarnings_=function(e,t){e&&"object"==typeof e&&O(e,"w")&&(e=A(e,"w"),Array.isArray(e)&&~e.indexOf("no_index")&&(e='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',t=t.path.toString(),Pe("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+e+" at "+t+" to your security rules for better performance.")))},Zt.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},Zt.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||function(e){return"object"==typeof(e=D(e).claims)&&!0===e.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},Zt.prototype.tryAuth=function(){var e,t,n,r=this;this.connected_&&this.authToken_&&(t=function(e){return!!(e=D(e).claims)&&"object"==typeof e&&e.hasOwnProperty("iat")}(e=this.authToken_)?"auth":"gauth",n={cred:e},null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(function(t){var n=t.s;t=t.d||"error",r.authToken_===e&&("ok"===n?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(n,t))})))},Zt.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),f(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},Zt.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t),e={p:e},r&&(e.q=n,e.t=r),this.sendRequest("n",e)},Zt.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},Zt.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},Zt.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},Zt.prototype.sendOnDisconnect_=function(e,t,n,r){n={p:t,d:n},this.log_("onDisconnect "+e,n),this.sendRequest(e,n,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))},Zt.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},Zt.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},Zt.prototype.putInternal=function(e,t,n,r,i){n={p:t,d:n},void 0!==i&&(n.h=i),this.outstandingPuts_.push({action:e,request:n,onComplete:r}),this.outstandingPutCount_++,r=this.outstandingPuts_.length-1,this.connected_?this.sendPut_(r):this.log_("Buffering put: "+t)},Zt.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))},Zt.prototype.reportStats=function(e){var t=this;this.connected_&&(e={c:e},this.log_("reportStats",e),this.sendRequest("s",e,(function(e){"ok"!==e.s&&(e=e.d,t.log_("reportStats","Error sending stats: "+e))})))},Zt.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+k(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},Zt.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):ce("Unrecognized action received from server: "+k(e)+"\nAre you using the latest client?")},Zt.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},Zt.prototype.scheduleConnect_=function(e){var t=this;f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},Zt.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},Zt.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},Zt.prototype.onRealtimeDisconnect_=function(){var e;this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()&&(this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=$t),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime()),e=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-e),e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)),this.onConnectStatus_(!1)},Zt.prototype.establishConnection_=function(){var e,t,n,r,i,o,s,a,u,l,h=this;this.shouldReconnect_()&&(this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Zt.nextConnectionId_++,o=(i=this).lastSessionId,s=!1,a=null,u=function(){a?a.close():(s=!0,n())},this.realtime_={close:u,sendRequest:function(e){f(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)}},l=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(l).then((function(u){s?Ie("getToken() completed but was canceled"):(Ie("getToken() completed. Creating connection."),i.authToken_=u&&u.accessToken,a=new vt(r,i.repoInfo_,i.applicationId_,e,t,n,(function(e){Pe(e+" ("+i.repoInfo_.toString()+")"),i.interrupt("server_kill")}),o))})).then(null,(function(e){i.log_("Failed to get token: "+e),s||(h.repoInfo_.nodeAdmin&&Pe(e),u())})))},Zt.prototype.interrupt=function(e){Ie("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},Zt.prototype.resume=function(e){Ie("Resuming connection for reason: "+e),delete this.interruptReasons_[e],L(this.interruptReasons_)&&(this.reconnectDelay_=$t,this.realtime_||this.scheduleConnect_(0))},Zt.prototype.handleTimestamp_=function(e){e-=(new Date).getTime(),this.onServerInfoUpdate_({serverTimeOffset:e})},Zt.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},Zt.prototype.onListenRevoked_=function(e,t){t=t?t.map((function(e){return ke(e)})).join("$"):"default",(t=this.removeListen_(e,t))&&t.onComplete&&t.onComplete("permission_denied")},Zt.prototype.removeListen_=function(e,t){var n,r=new Nt(e).toString();return this.listens.has(r)?(n=(e=this.listens.get(r)).get(t),e.delete(t),0===e.size&&this.listens.delete(r)):n=void 0,n},Zt.prototype.onAuthRevoked_=function(e,t){Ie("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},Zt.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},Zt.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=u(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,u(s.values())),l=a.next();!l.done;l=a.next()){var h=l.value;this.sendListen_(h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var c=0;c<this.outstandingPuts_.length;c++)this.outstandingPuts_[c]&&this.sendPut_(c);for(;this.onDisconnectRequestQueue_.length;){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(c=0;c<this.outstandingGets_.length;c++)this.outstandingGets_[c]&&this.sendGet_(c)},Zt.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+ht.replace(/\./g,"-")]=1,C()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)},Zt.prototype.shouldReconnect_=function(){var e=It.getInstance().currentlyOnline();return L(this.interruptReasons_)&&e},Zt.nextPersistentConnectionId_=0,Zt.nextConnectionId_=0,Zt);function Zt(e,t,n,r,i,o,s){var a=Gt.call(this)||this;if(a.repoInfo_=e,a.applicationId_=t,a.onDataUpdate_=n,a.onConnectStatus_=r,a.onServerInfoUpdate_=i,a.authTokenProvider_=o,a.authOverride_=s,a.id=Zt.nextPersistentConnectionId_++,a.log_=Se("p:"+a.id+":"),a.interruptReasons_={},a.listens=new Map,a.outstandingPuts_=[],a.outstandingGets_=[],a.outstandingPutCount_=0,a.outstandingGetCount_=0,a.onDisconnectRequestQueue_=[],a.connected_=!1,a.reconnectDelay_=$t,a.maxReconnectDelay_=Jt,a.securityDebugCallback_=null,a.lastSessionId=null,a.establishConnectionTimer_=null,a.visible_=!1,a.requestCBHash_={},a.requestNumber_=0,a.realtime_=null,a.authToken_=null,a.forceTokenRefresh_=!1,a.invalidAuthTokenCount_=0,a.firstConnection_=!0,a.lastConnectionAttemptTime_=null,a.lastConnectionEstablishedTime_=null,s&&!b())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return a.scheduleConnect_(0),Kt.getInstance().on("visible",a.onVisible_,a),-1===e.host.indexOf("fblocal")&&It.getInstance().on("online",a.onOnline_,a),a}var en=(tn.Wrap=function(e,t){return new tn(e,t)},tn);function tn(e,t){this.name=e,this.node=t}var nn,rn,on=(sn.prototype.getCompare=function(){return this.compare.bind(this)},sn.prototype.indexedValueChanged=function(e,t){return e=new en(Ne,e),t=new en(Ne,t),0!==this.compare(e,t)},sn.prototype.minPost=function(){return en.MIN},sn);function sn(){}function an(){return null!==rn&&rn.apply(this,arguments)||this}var un=new(i(an,rn=on),Object.defineProperty(an,"__EMPTY_NODE",{get:function(){return nn},set:function(e){nn=e},enumerable:!1,configurable:!0}),an.prototype.compare=function(e,t){return xe(e.name,t.name)},an.prototype.isDefinedOn=function(e){throw _("KeyIndex.isDefinedOn not expected to be called.")},an.prototype.indexedValueChanged=function(e,t){return!1},an.prototype.minPost=function(){return en.MIN},an.prototype.maxPost=function(){return new en(Re,nn)},an.prototype.makePost=function(e,t){return f("string"==typeof e,"KeyIndex indexValue must always be a string."),new en(e,nn)},an.prototype.toString=function(){return".key"},re=an),ln=(hn.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_.pop(),t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value};if(this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},hn.prototype.hasNext=function(){return 0<this.nodeStack_.length},hn.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},hn);function hn(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}var cn=(dn.prototype.copy=function(e,t,n,r,i){return new dn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},dn.prototype.count=function(){return this.left.count()+1+this.right.count()},dn.prototype.isEmpty=function(){return!1},dn.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},dn.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},dn.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},dn.prototype.minKey=function(){return this.min_().key},dn.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},dn.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},dn.prototype.removeMin_=function(){if(this.left.isEmpty())return _n.EMPTY_NODE;var e=this;return(e=(e=e.left.isRed_()||e.left.left.isRed_()?e:e.moveRedLeft_()).copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},dn.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r=(r=r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()?r:r.moveRedLeft_()).copy(null,null,null,r.left.remove(e,t),null);else{if(0===t(e,(r=(r=r.left.isRed_()?r.rotateRight_():r).right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()?r:r.moveRedRight_()).key)){if(r.right.isEmpty())return _n.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},dn.prototype.isRed_=function(){return this.color},dn.prototype.fixUp_=function(){var e=this;return(e=(e=e.right.isRed_()&&!e.left.isRed_()?e.rotateLeft_():e).left.isRed_()&&e.left.left.isRed_()?e.rotateRight_():e).left.isRed_()&&e.right.isRed_()?e.colorFlip_():e},dn.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()?(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_():e},dn.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()?(e=e.rotateRight_()).colorFlip_():e},dn.prototype.rotateLeft_=function(){var e=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},dn.prototype.rotateRight_=function(){var e=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},dn.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},dn.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},dn.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},dn.RED=!0,dn.BLACK=!1,dn);function dn(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:dn.RED,this.left=null!=r?r:_n.EMPTY_NODE,this.right=null!=i?i:_n.EMPTY_NODE}function pn(){}pn.prototype.copy=function(e,t,n,r,i){return this},pn.prototype.insert=function(e,t,n){return new cn(e,t,null)},pn.prototype.remove=function(e,t){return this},pn.prototype.count=function(){return 0},pn.prototype.isEmpty=function(){return!0},pn.prototype.inorderTraversal=function(e){return!1},pn.prototype.reverseTraversal=function(e){return!1},pn.prototype.minKey=function(){return null},pn.prototype.maxKey=function(){return null},pn.prototype.check_=function(){return 0},pn.prototype.isRed_=function(){return!1},Ct=pn;var fn,_n=(yn.prototype.insert=function(e,t){return new yn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,cn.BLACK,null,null))},yn.prototype.remove=function(e){return new yn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,cn.BLACK,null,null))},yn.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null},yn.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},yn.prototype.isEmpty=function(){return this.root_.isEmpty()},yn.prototype.count=function(){return this.root_.count()},yn.prototype.minKey=function(){return this.root_.minKey()},yn.prototype.maxKey=function(){return this.root_.maxKey()},yn.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},yn.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},yn.prototype.getIterator=function(e){return new ln(this.root_,null,this.comparator_,!1,e)},yn.prototype.getIteratorFrom=function(e,t){return new ln(this.root_,e,this.comparator_,!1,t)},yn.prototype.getReverseIteratorFrom=function(e,t){return new ln(this.root_,e,this.comparator_,!0,t)},yn.prototype.getReverseIterator=function(e){return new ln(this.root_,null,this.comparator_,!0,e)},yn.EMPTY_NODE=new Ct,yn);function yn(e,t){void 0===t&&(t=yn.EMPTY_NODE),this.comparator_=e,this.root_=t}function vn(e,t){return xe(e.name,t.name)}function gn(e,t){return xe(e,t)}function mn(e){return"number"==typeof e?"number:"+Oe(e):"string:"+e}var wn,Cn,bn,En,In=function(e){var t;e.isLeafNode()?(t=e.val(),f("string"==typeof t||"number"==typeof t||"object"==typeof t&&O(t,".sv"),"Priority must be a string or number.")):f(e===fn||e.isEmpty(),"priority of unexpected type."),f(e===fn||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Sn=(Object.defineProperty(Tn,"__childrenNodeConstructor",{get:function(){return wn},set:function(e){wn=e},enumerable:!1,configurable:!0}),Tn.prototype.isLeafNode=function(){return!0},Tn.prototype.getPriority=function(){return this.priorityNode_},Tn.prototype.updatePriority=function(e){return new Tn(this.value_,e)},Tn.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:Tn.__childrenNodeConstructor.EMPTY_NODE},Tn.prototype.getChild=function(e){return qt(e)?this:".priority"===kt(e)?this.priorityNode_:Tn.__childrenNodeConstructor.EMPTY_NODE},Tn.prototype.hasChild=function(){return!1},Tn.prototype.getPredecessorChildName=function(e,t){return null},Tn.prototype.updateImmediateChild=function(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Tn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)},Tn.prototype.updateChild=function(e,t){var n=kt(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(f(".priority"!==n||1===Dt(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Tn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ot(e),t)))},Tn.prototype.isEmpty=function(){return!1},Tn.prototype.numChildren=function(){return 0},Tn.prototype.forEachChild=function(e,t){return!1},Tn.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},Tn.prototype.hash=function(){var e,t;return null===this.lazyHash_&&(e="",this.priorityNode_.isEmpty()||(e+="priority:"+mn(this.priorityNode_.val())+":"),e+=(t=typeof this.value_)+":",e+="number"==t?Oe(this.value_):this.value_,this.lazyHash_=le(e)),this.lazyHash_},Tn.prototype.getValue=function(){return this.value_},Tn.prototype.compareTo=function(e){return e===Tn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Tn.__childrenNodeConstructor?-1:(f(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},Tn.prototype.compareToLeafNode_=function(e){var t=typeof e.value_,n=typeof this.value_,r=Tn.VALUE_TYPE_ORDER.indexOf(t),i=Tn.VALUE_TYPE_ORDER.indexOf(n);return f(0<=r,"Unknown leaf type: "+t),f(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r},Tn.prototype.withIndex=function(){return this},Tn.prototype.isIndexed=function(){return!0},Tn.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)},Tn.VALUE_TYPE_ORDER=["object","boolean","number","string"],Tn);function Tn(e,t){void 0===t&&(t=Tn.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=t,this.lazyHash_=null,f(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),In(this.priorityNode_)}function Pn(){return null!==En&&En.apply(this,arguments)||this}var Nn=new(i(Pn,En=on),Pn.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority();return 0===(r=n.compareTo(r))?xe(e.name,t.name):r},Pn.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},Pn.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},Pn.prototype.minPost=function(){return en.MIN},Pn.prototype.maxPost=function(){return new en(Re,new Sn("[PRIORITY-POST]",bn))},Pn.prototype.makePost=function(e,t){return e=Cn(e),new en(t,new Sn("[PRIORITY-POST]",e))},Pn.prototype.toString=function(){return".priority"},Pn),Rn=Math.log(2),xn=(kn.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},kn);function kn(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Rn,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}var Dn,On,An=function(e,t,n,r){e.sort(t);var i=function t(r,i){if(0==(o=i-r))return null;if(1==o)return s=e[r],a=n?n(s):s,new cn(a,s.node,cn.BLACK,null,null);r=t(r,o=parseInt(o/2,10)+r),i=t(o+1,i);var o,s=e[o],a=n?n(s):s;return new cn(a,s.node,cn.BLACK,r,i)},o=function(t){for(var r=null,o=null,s=e.length,a=function(t,r){var o=s-t,a=s;s-=t,t=i(1+o,a),a=e[o],o=n?n(a):a,u(new cn(o,a.node,r,null,t))},u=function(e){r=r?r.left=e:o=e},l=0;l<t.count;++l){var h=t.nextBitIsOne(),c=Math.pow(2,t.count-(l+1));h?a(c,cn.BLACK):(a(c,cn.BLACK),a(c,cn.RED))}return o}(new xn(e.length));return new _n(r||t,o)},Ln={},Mn=(Object.defineProperty(Fn,"Default",{get:function(){return f(Nn,"ChildrenNode.ts has not been loaded"),Dn=Dn||new Fn({".priority":Ln},{".priority":Nn})},enumerable:!1,configurable:!0}),Fn.prototype.get=function(e){var t=A(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof _n?t:null},Fn.prototype.hasIndex=function(e){return O(this.indexSet_,e.toString())},Fn.prototype.addIndex=function(e,t){f(e!==un,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n=[],r=!1,i=t.getIterator(en.Wrap),s=i.getNext();s;)r=r||e.isDefinedOn(s.node),n.push(s),s=i.getNext();var a=r?An(n,e.getCompare()):Ln,u=e.toString(),l=o({},this.indexSet_);return l[u]=e,(t=o({},this.indexes_))[u]=a,new Fn(t,l)},Fn.prototype.addToIndexes=function(e,t){var n=this;return new Fn(M(this.indexes_,(function(r,i){var o=A(n.indexSet_,i);if(f(o,"Missing index implementation for "+i),r===Ln){if(o.isDefinedOn(e.node)){for(var s=[],a=t.getIterator(en.Wrap),u=a.getNext();u;)u.name!==e.name&&s.push(u),u=a.getNext();return s.push(e),An(s,o.getCompare())}return Ln}return(r=(o=t.get(e.name))?r.remove(new en(e.name,o)):r).insert(e,e.node)})),this.indexSet_)},Fn.prototype.removeFromIndexes=function(e,t){return new Fn(M(this.indexes_,(function(n){if(n===Ln)return n;var r=t.get(e.name);return r?n.remove(new en(e.name,r)):n})),this.indexSet_)},Fn);function Fn(e,t){this.indexes_=e,this.indexSet_=t}var qn,Wn=(Object.defineProperty(Qn,"EMPTY_NODE",{get:function(){return On=On||new Qn(new _n(gn),null,Mn.Default)},enumerable:!1,configurable:!0}),Qn.prototype.isLeafNode=function(){return!1},Qn.prototype.getPriority=function(){return this.priorityNode_||On},Qn.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new Qn(this.children_,e,this.indexMap_)},Qn.prototype.getImmediateChild=function(e){return".priority"===e?this.getPriority():null===(e=this.children_.get(e))?On:e},Qn.prototype.getChild=function(e){var t=kt(e);return null===t?this:this.getImmediateChild(t).getChild(Ot(e))},Qn.prototype.hasChild=function(e){return null!==this.children_.get(e)},Qn.prototype.updateImmediateChild=function(e,t){if(f(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);var n=new en(e,t),r=void 0,i=void 0;return i=t.isEmpty()?(r=this.children_.remove(e),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),this.indexMap_.addToIndexes(n,this.children_)),n=r.isEmpty()?On:this.priorityNode_,new Qn(r,n,i)},Qn.prototype.updateChild=function(e,t){var n=kt(e);return null===n?t:(f(".priority"!==kt(e)||1===Dt(e),".priority must be the last token in a path"),t=this.getImmediateChild(n).updateChild(Ot(e),t),this.updateImmediateChild(n,t))},Qn.prototype.isEmpty=function(){return this.children_.isEmpty()},Qn.prototype.numChildren=function(){return this.children_.count()},Qn.prototype.val=function(e){if(this.isEmpty())return null;var t={},n=0,r=0,i=!0;if(this.forEachChild(Nn,(function(o,s){t[o]=s.val(e),n++,i&&Qn.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){var o,s=[];for(o in t)s[o]=t[o];return s}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t},Qn.prototype.hash=function(){var e;return null===this.lazyHash_&&(e="",this.getPriority().isEmpty()||(e+="priority:"+mn(this.getPriority().val())+":"),this.forEachChild(Nn,(function(t,n){""!==(n=n.hash())&&(e+=":"+t+":"+n)})),this.lazyHash_=""===e?"":le(e)),this.lazyHash_},Qn.prototype.getPredecessorChildName=function(e,t,n){return(n=this.resolveIndex_(n))?(t=n.getPredecessorKey(new en(e,t)))?t.name:null:this.children_.getPredecessorKey(e)},Qn.prototype.getFirstChildName=function(e){return(e=this.resolveIndex_(e))?(e=e.minKey())&&e.name:this.children_.minKey()},Qn.prototype.getFirstChild=function(e){return(e=this.getFirstChildName(e))?new en(e,this.children_.get(e)):null},Qn.prototype.getLastChildName=function(e){return(e=this.resolveIndex_(e))?(e=e.maxKey())&&e.name:this.children_.maxKey()},Qn.prototype.getLastChild=function(e){return(e=this.getLastChildName(e))?new en(e,this.children_.get(e)):null},Qn.prototype.forEachChild=function(e,t){return(e=this.resolveIndex_(e))?e.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},Qn.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},Qn.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,en.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},Qn.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},Qn.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,en.Wrap),i=r.peek();null!=i&&0<t.compare(i,e);)r.getNext(),i=r.peek();return r},Qn.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Un?-1:0},Qn.prototype.withIndex=function(e){return e===un||this.indexMap_.hasIndex(e)?this:(e=this.indexMap_.addIndex(e,this.children_),new Qn(this.children_,this.priorityNode_,e))},Qn.prototype.isIndexed=function(e){return e===un||this.indexMap_.hasIndex(e)},Qn.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var t=this.getIterator(Nn),n=e.getIterator(Nn),r=t.getNext(),i=n.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1},Qn.prototype.resolveIndex_=function(e){return e===un?null:this.indexMap_.get(e.toString())},Qn.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,Qn);function Qn(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&In(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}function jn(){return qn.call(this,new _n(gn),Wn.EMPTY_NODE,Mn.Default)||this}var Un=new(i(jn,qn=Wn),jn.prototype.compareTo=function(e){return e===this?0:1},jn.prototype.equals=function(e){return e===this},jn.prototype.getPriority=function(){return this},jn.prototype.getImmediateChild=function(e){return Wn.EMPTY_NODE},jn.prototype.isEmpty=function(){return!1},jn);Object.defineProperties(en,{MIN:{value:new en(Ne,Wn.EMPTY_NODE)},MAX:{value:new en(Re,Un)}}),re.__EMPTY_NODE=Wn.EMPTY_NODE,Sn.__childrenNodeConstructor=Wn,fn=Un,bn=Un;var Bn=!0;function Hn(e,t){if(void 0===t&&(t=null),null===e)return Wn.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),f(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Sn(e,Hn(t));if(e instanceof Array||!Bn){var n=Wn.EMPTY_NODE;return De(e,(function(t,r){O(e,t)&&"."!==t.substring(0,1)&&(!(r=Hn(r)).isLeafNode()&&r.isEmpty()||(n=n.updateImmediateChild(t,r)))})),n.updatePriority(Hn(t))}var r=[],i=!1;if(De(e,(function(e,t){"."!==e.substring(0,1)&&((t=Hn(t)).isEmpty()||(i=i||!t.getPriority().isEmpty(),r.push(new en(e,t))))})),0===r.length)return Wn.EMPTY_NODE;var o=An(r,vn,(function(e){return e.name}),gn);if(i){var s=An(r,Nn.getCompare());return new Wn(o,Hn(t),new Mn({".priority":s},{".priority":Nn}))}return new Wn(o,Hn(t),Mn.Default)}Cn=Hn;var Vn,zn,Kn=(i(Yn,Vn=on),Yn.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},Yn.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},Yn.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node);return 0===(r=n.compareTo(r))?xe(e.name,t.name):r},Yn.prototype.makePost=function(e,t){return e=Hn(e),e=Wn.EMPTY_NODE.updateChild(this.indexPath_,e),new en(t,e)},Yn.prototype.maxPost=function(){var e=Wn.EMPTY_NODE.updateChild(this.indexPath_,Un);return new en(Re,e)},Yn.prototype.toString=function(){return Lt(this.indexPath_,0).join("/")},Yn);function Yn(e){var t=Vn.call(this)||this;return t.indexPath_=e,f(!qt(e)&&".priority"!==kt(e),"Can't create PathIndex with empty path or .priority key"),t}function Gn(){return null!==zn&&zn.apply(this,arguments)||this}function $n(e){if(e===""+qe)return"-";var t=We(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;0<=i&&"z"===n[i];)i--;return-1===i?Re:(t=n[i],t=tr.charAt(tr.indexOf(t)+1),n[i]=t,n.slice(0,i+1).join(""))}function Jn(e){if(e===""+Fe)return Ne;var t=We(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?""+qe:(delete n[n.length-1],n.join("")):(n[n.length-1]=tr.charAt(tr.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))}var Xn,Zn,er=new(i(Gn,zn=on),Gn.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?xe(e.name,t.name):n},Gn.prototype.isDefinedOn=function(e){return!0},Gn.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},Gn.prototype.minPost=function(){return en.MIN},Gn.prototype.maxPost=function(){return en.MAX},Gn.prototype.makePost=function(e,t){return e=Hn(e),new en(t,e)},Gn.prototype.toString=function(){return".value"},Gn),tr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",nr=(Xn=0,Zn=[],function(e){var t=e===Xn;Xn=e;for(var n=new Array(8),r=7;0<=r;r--)n[r]=tr.charAt(e%64),e=Math.floor(e/64);f(0===e,"Cannot push at time == 0");var i=n.join("");if(t){for(r=11;0<=r&&63===Zn[r];r--)Zn[r]=0;Zn[r]++}else for(r=0;r<12;r++)Zn[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)i+=tr.charAt(Zn[r]);return f(20===i.length,"nextPushId: Length should be 20."),i});function rr(e){return{type:"value",snapshotNode:e}}function ir(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function or(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function sr(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var ar=(ur.prototype.updateChild=function(e,t,n,r,i,o){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(or(t,s)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(ir(t,n)):o.trackChildChange(sr(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},ur.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Nn,(function(e,r){t.hasChild(e)||n.trackChildChange(or(e,r))})),t.isLeafNode()||t.forEachChild(Nn,(function(t,r){var i;e.hasChild(t)?(i=e.getImmediateChild(t)).equals(r)||n.trackChildChange(sr(t,r,i)):n.trackChildChange(ir(t,r))}))),t.withIndex(this.index_)},ur.prototype.updatePriority=function(e,t){return e.isEmpty()?Wn.EMPTY_NODE:e.updatePriority(t)},ur.prototype.filtersNodes=function(){return!1},ur.prototype.getIndexedFilter=function(){return this},ur.prototype.getIndex=function(){return this.index_},ur);function ur(e){this.index_=e}var lr=(hr.prototype.getStartPost=function(){return this.startPost_},hr.prototype.getEndPost=function(){return this.endPost_},hr.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},hr.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new en(t,n))||(n=Wn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},hr.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Wn.EMPTY_NODE);var r=(r=t.withIndex(this.index_)).updatePriority(Wn.EMPTY_NODE),i=this;return t.forEachChild(Nn,(function(e,t){i.matches(new en(e,t))||(r=r.updateImmediateChild(e,Wn.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},hr.prototype.updatePriority=function(e,t){return e},hr.prototype.filtersNodes=function(){return!0},hr.prototype.getIndexedFilter=function(){return this.indexedFilter_},hr.prototype.getIndex=function(){return this.index_},hr.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},hr.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},hr);function hr(e){this.indexedFilter_=new ar(e.getIndex()),this.index_=e.getIndex(),this.startPost_=hr.getStartPost_(e),this.endPost_=hr.getEndPost_(e)}var cr=(dr.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new en(t,n))||(n=Wn.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},dr.prototype.updateFullNode=function(e,t,n){if(t.isLeafNode()||t.isEmpty())r=Wn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var r=Wn.EMPTY_NODE.withIndex(this.index_),i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Wn.EMPTY_NODE);var a,u=void 0,l=void 0,h=void 0;i=void 0,h=this.reverse_?(i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost(),a=this.index_.getCompare(),function(e,t){return a(t,e)}):(i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),this.index_.getCompare()),o=0;for(var c=!1;i.hasNext();)s=i.getNext(),(c=!c&&h(u,s)<=0||c)&&o<this.limit_&&h(s,l)<=0?o++:r=r.updateImmediateChild(s.name,Wn.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},dr.prototype.updatePriority=function(e,t){return e},dr.prototype.filtersNodes=function(){return!0},dr.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},dr.prototype.getIndex=function(){return this.index_},dr.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o,s;s=this.reverse_?(o=this.index_.getCompare(),function(e,t){return o(t,e)}):this.index_.getCompare();var a=e;f(a.numChildren()===this.limit_,"");var u=new en(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(t)){for(var c=a.getImmediateChild(t),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===t||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:s(d,u);return h&&!n.isEmpty()&&0<=p?(null!=i&&i.trackChildChange(sr(t,n,c)),a.updateImmediateChild(t,n)):(null!=i&&i.trackChildChange(or(t,c)),c=a.updateImmediateChild(t,Wn.EMPTY_NODE),null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(ir(d.name,d.node)),c.updateImmediateChild(d.name,d.node)):c)}return!n.isEmpty()&&h&&0<=s(l,u)?(null!=i&&(i.trackChildChange(or(l.name,l.node)),i.trackChildChange(ir(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,Wn.EMPTY_NODE)):e},dr);function dr(e){this.rangedFilter_=new lr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}var pr=(fr.prototype.hasStart=function(){return this.startSet_},fr.prototype.hasStartAfter=function(){return this.startAfterSet_},fr.prototype.hasEndBefore=function(){return this.endBeforeSet_},fr.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},fr.prototype.getIndexStartValue=function(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},fr.prototype.getIndexStartName=function(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ne},fr.prototype.hasEnd=function(){return this.endSet_},fr.prototype.getIndexEndValue=function(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},fr.prototype.getIndexEndName=function(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Re},fr.prototype.hasLimit=function(){return this.limitSet_},fr.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},fr.prototype.getLimit=function(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_},fr.prototype.getIndex=function(){return this.index_},fr.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},fr.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Nn},fr.prototype.copy=function(){var e=new fr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},fr);function fr(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Nn}function _r(e,t,n){return(e=e.copy()).startSet_=!0,void 0===t&&(t=null),e.indexStartValue_=t,null!=n?(e.startNameSet_=!0,e.indexStartName_=n):(e.startNameSet_=!1,e.indexStartName_=""),e}function yr(e,t,n){return(e=e.copy()).endSet_=!0,void 0===t&&(t=null),e.indexEndValue_=t,void 0!==n?(e.endNameSet_=!0,e.indexEndName_=n):(e.endNameSet_=!1,e.indexEndName_=""),e}function vr(e,t){return(e=e.copy()).index_=t,e}function gr(e){var t,n={};return e.isDefault()||(t=e.index_===Nn?"$priority":e.index_===er?"$value":e.index_===un?"$key":(f(e.index_ instanceof Kn,"Unrecognized index type!"),e.index_.toString()),n.orderBy=k(t),e.startSet_&&(n.startAt=k(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+k(e.indexStartName_))),e.endSet_&&(n.endAt=k(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+k(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}var mr,wr=(i(Cr,mr=mt),Cr.prototype.reportStats=function(e){throw new Error("Method not implemented.")},Cr.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(f(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},Cr.prototype.listen=function(e,t,n,r){var i=this,o=e.path.toString();this.log_("Listen called for "+o+" "+e.queryIdentifier());var s=Cr.getListenId_(e,n),a={};this.listens_[s]=a,e=gr(e.getQueryParams()),this.restRequest_(o+".json",e,(function(e,t){null===(e=404===e?t=null:e)&&i.onDataUpdate_(o,t,!1,n),A(i.listens_,s)===a&&r(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))},Cr.prototype.unlisten=function(e,t){t=Cr.getListenId_(e,t),delete this.listens_[t]},Cr.prototype.get=function(e){var t=this,n=gr(e.getQueryParams()),r=e.path.toString(),i=new m;return this.restRequest_(r+".json",n,(function(e,n){null===(e=404===e?n=null:e)?(t.onDataUpdate_(r,n,!1,null),i.resolve(n)):i.reject(new Error(n))})),i.promise},Cr.prototype.refreshAuthToken=function(e){},Cr.prototype.restRequest_=function(e,t,n){var r=this;(t=void 0===t?{}:t).format="export",this.authTokenProvider_.getToken(!1).then((function(i){(i=i&&i.accessToken)&&(t.auth=i);var o=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+F(t);r.log_("Sending REST request for "+o);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(n&&4===s.readyState){r.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);var e=null;if(200<=s.status&&s.status<300){try{e=x(s.responseText)}catch(e){Pe("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&Pe("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))},Cr);function Cr(e,t,n){var r=mr.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=t,r.authTokenProvider_=n,r.log_=Se("p:rest:"),r.listens_={},r}var br=(Er.prototype.getNode=function(e){return this.rootNode_.getChild(e)},Er.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},Er);function Er(){this.rootNode_=Wn.EMPTY_NODE}function Ir(){return{value:null,children:new Map}}function Sr(e,t,n){var r;qt(t)?(e.value=n,e.children.clear()):null!==e.value?e.value=e.value.updateChild(t,n):(r=kt(t),e.children.has(r)||e.children.set(r,Ir()),Sr(e.children.get(r),t=Ot(t),n))}function Tr(e,t,n){var r;null!==e.value?n(t,e.value):(r=function(e,r){Tr(r,new Nt(t.toString()+"/"+e),n)},e.children.forEach((function(e,t){r(t,e)})))}var Pr=(Nr.prototype.get=function(){var e=this.collection_.get(),t=o({},e);return this.last_&&De(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},Nr);function Nr(e){this.collection_=e,this.last_=null}var Rr,xr=(kr.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;De(t,(function(t,i){0<i&&O(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),Ae(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},kr);function kr(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pr(e),e=1e4+2e4*Math.random(),Ae(this.reportStats_.bind(this),Math.floor(e))}function Dr(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Or(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Ar(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(mt=Rr=Rr||{})[mt.OVERWRITE=0]="OVERWRITE",mt[mt.MERGE=1]="MERGE",mt[mt.ACK_USER_WRITE=2]="ACK_USER_WRITE",mt[mt.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Lr=(Mr.prototype.operationForChild=function(e){if(qt(this.path)){if(null!=this.affectedTree.value)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new Nt(e));return new Mr(xt(),t,this.revert)}return f(kt(this.path)===e,"operationForChild called for unrelated child."),new Mr(Ot(this.path),this.affectedTree,this.revert)},Mr);function Mr(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Rr.ACK_USER_WRITE,this.source=Dr()}var Fr=(qr.prototype.operationForChild=function(e){return qt(this.path)?new qr(this.source,xt()):new qr(this.source,Ot(this.path))},qr);function qr(e,t){this.source=e,this.path=t,this.type=Rr.LISTEN_COMPLETE}var Wr=(Qr.prototype.operationForChild=function(e){return qt(this.path)?new Qr(this.source,xt(),this.snap.getImmediateChild(e)):new Qr(this.source,Ot(this.path),this.snap)},Qr);function Qr(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Rr.OVERWRITE}var jr=(Ur.prototype.operationForChild=function(e){if(qt(this.path)){var t=this.children.subtree(new Nt(e));return t.isEmpty()?null:t.value?new Wr(this.source,xt(),t.value):new Ur(this.source,xt(),t)}return f(kt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ur(this.source,Ot(this.path),this.children)},Ur.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Ur);function Ur(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Rr.MERGE}var Br=(Hr.prototype.isFullyInitialized=function(){return this.fullyInitialized_},Hr.prototype.isFiltered=function(){return this.filtered_},Hr.prototype.isCompleteForPath=function(e){return qt(e)?this.isFullyInitialized()&&!this.filtered_:(e=kt(e),this.isCompleteForChild(e))},Hr.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},Hr.prototype.getNode=function(){return this.node_},Hr);function Hr(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}var Vr,zr=function(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()};function Kr(e,t,n,r){var i=[],o=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Yr(e,i,"child_removed",t,r,n),Yr(e,i,"child_added",t,r,n),Yr(e,i,"child_moved",o,r,n),Yr(e,i,"child_changed",t,r,n),Yr(e,i,"value",t,r,n),i}function Yr(e,t,n,r,i,o){(r=r.filter((function(e){return e.type===n}))).sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw _("Should only compare child_ events.");return t=new en(t.childName,t.snapshotNode),n=new en(n.childName,n.snapshotNode),e.index_.compare(t,n)}(e,t,n)})),r.forEach((function(n){var r,s,a,u=(r=e,a=o,"value"===(s=n).type||"child_removed"===s.type||(s.prevName=a.getPredecessorChildName(s.childName,s.snapshotNode,r.index_)),s);i.forEach((function(r){r.respondsTo(n.type)&&t.push(r.createEvent(u,e.query_))}))}))}function Gr(e,t){return{eventCache:e,serverCache:t}}function $r(e,t,n,r){return Gr(new Br(t,n,r),e.serverCache)}function Jr(e,t,n,r){return Gr(e.eventCache,new Br(t,n,r))}function Xr(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Zr(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var ei=(ti.fromObject=function(e){var t=new ti(null);return De(e,(function(e,n){t=t.set(new Nt(e),n)})),t},ti.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},ti.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:xt(),value:this.value};if(qt(e))return null;var n=kt(e),r=this.children.get(n);return null===r||null==(t=r.findRootMostMatchingPathAndValue(Ot(e),t))?null:{path:Ft(new Nt(n),t.path),value:t.value}},ti.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},ti.prototype.subtree=function(e){if(qt(e))return this;var t=kt(e);return null!==(t=this.children.get(t))?t.subtree(Ot(e)):new ti(null)},ti.prototype.set=function(e,t){if(qt(e))return new ti(t,this.children);var n=kt(e);return t=(this.children.get(n)||new ti(null)).set(Ot(e),t),t=this.children.insert(n,t),new ti(this.value,t)},ti.prototype.remove=function(e){if(qt(e))return this.children.isEmpty()?new ti(null):new ti(null,this.children);var t=kt(e),n=this.children.get(t);return n?(n=n.remove(Ot(e)),e=void 0,e=n.isEmpty()?this.children.remove(t):this.children.insert(t,n),null===this.value&&e.isEmpty()?new ti(null):new ti(this.value,e)):this},ti.prototype.get=function(e){if(qt(e))return this.value;var t=kt(e);return(t=this.children.get(t))?t.get(Ot(e)):null},ti.prototype.setTree=function(e,t){if(qt(e))return t;var n=kt(e);return e=(this.children.get(n)||new ti(null)).setTree(Ot(e),t),t=void 0,t=e.isEmpty()?this.children.remove(n):this.children.insert(n,e),new ti(this.value,t)},ti.prototype.fold=function(e){return this.fold_(xt(),e)},ti.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Ft(e,r),t)})),t(e,this.value,n)},ti.prototype.findOnPath=function(e,t){return this.findOnPath_(e,xt(),t)},ti.prototype.findOnPath_=function(e,t,n){if(r=!!this.value&&n(t,this.value))return r;if(qt(e))return null;var r,i=kt(e);return(r=this.children.get(i))?r.findOnPath_(Ot(e),Ft(t,i),n):null},ti.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,xt(),t)},ti.prototype.foreachOnPath_=function(e,t,n){if(qt(e))return this;this.value&&n(t,this.value);var r=kt(e),i=this.children.get(r);return i?i.foreachOnPath_(Ot(e),Ft(t,r),n):new ti(null)},ti.prototype.foreach=function(e){this.foreach_(xt(),e)},ti.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Ft(e,n),t)})),this.value&&t(e,this.value)},ti.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},ti);function ti(e,t){void 0===t&&(t=Vr=Vr||new _n(pe)),this.value=e,this.children=t}var ni=(ri.empty=function(){return new ri(new ei(null))},ri);function ri(e){this.writeTree_=e}function ii(e,t,n){if(qt(t))return new ni(new ei(n));if(null!=(o=e.writeTree_.findRootMostValueAndPath(t))){var r=o.path,i=o.value,o=Wt(r,t);return i=i.updateChild(o,n),new ni(e.writeTree_.set(r,i))}return n=new ei(n),n=e.writeTree_.setTree(t,n),new ni(n)}function oi(e,t,n){var r=e;return De(n,(function(e,n){r=ii(r,Ft(t,e),n)})),r}function si(e,t){return qt(t)?ni.empty():(t=e.writeTree_.setTree(t,new ei(null)),new ni(t))}function ai(e,t){return null!=ui(e,t)}function ui(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Wt(n.path,t)):null}function li(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Nn,(function(e,n){t.push(new en(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new en(e,n.value))})),t}function hi(e,t){if(qt(t))return e;var n=ui(e,t);return new ni(null!=n?new ei(n):e.writeTree_.subtree(t))}function ci(e){return e.writeTree_.isEmpty()}function di(e,t){return function e(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal((function(n,o){".priority"===n?(f(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e(Ft(t,n),o,r)})),r=r.getChild(t).isEmpty()||null===i?r:r.updateChild(Ft(t,".priority"),i)}(xt(),e.writeTree_,t)}function pi(e,t){return Si(t,e)}function fi(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));f(0<=n,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i,o=r.visible,s=!1,a=e.allWrites.length-1;o&&0<=a;){var u=e.allWrites[a];u.visible&&(n<=a&&function(e,t){if(e.snap)return Ut(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Ut(Ft(e.path,n),t))return!0;return!1}(u,r.path)?o=!1:Ut(r.path,u.path)&&(s=!0)),a--}return!!o&&(s?((i=e).visibleWrites=yi(i.allWrites,_i,xt()),0<i.allWrites.length?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1):r.snap?e.visibleWrites=si(e.visibleWrites,r.path):De(r.children,(function(t){e.visibleWrites=si(e.visibleWrites,Ft(r.path,t))})),!0)}function _i(e){return e.visible}function yi(e,t,n){for(var r=ni.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var s=o.path,a=void 0;if(o.snap)Ut(n,s)?r=ii(r,a=Wt(n,s),o.snap):Ut(s,n)&&(a=Wt(s,n),r=ii(r,xt(),o.snap.getChild(a)));else{if(!o.children)throw _("WriteRecord should have .snap or .children");Ut(n,s)?r=oi(r,a=Wt(n,s),o.children):Ut(s,n)&&(qt(a=Wt(s,n))?r=oi(r,xt(),o.children):(o=A(o.children,kt(a)))&&(a=o.getChild(Ot(a)),r=ii(r,xt(),a)))}}}return r}function vi(e,t,n,r,i){if(r||i){var o=hi(e.visibleWrites,t);return!i&&ci(o)?n:i||null!=n||ai(o,xt())?di(yi(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Ut(e.path,t)||Ut(t,e.path))}),t),n||Wn.EMPTY_NODE):null}return null!=(o=ui(e.visibleWrites,t))?o:ci(e=hi(e.visibleWrites,t))?n:null!=n||ai(e,xt())?di(e,n||Wn.EMPTY_NODE):null}function gi(e,t,n,r){return vi(e.writeTree,e.treePath,t,n,r)}function mi(e,t){return function(e,t,n){var r=Wn.EMPTY_NODE,i=ui(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Nn,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=hi(e.visibleWrites,t);return n.forEachChild(Nn,(function(e,t){t=di(hi(o,new Nt(e)),t),r=r.updateImmediateChild(e,t)})),li(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return li(hi(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function wi(e,t,n,r){return i=e.writeTree,e=e.treePath,t=t,r=r,f(n||r,"Either existingEventSnap or existingServerSnap must exist"),e=Ft(e,t),ai(i.visibleWrites,e)?null:ci(e=hi(i.visibleWrites,e))?r.getChild(t):di(e,r.getChild(t));var i}function Ci(e,t){return n=e.writeTree,t=Ft(e.treePath,t),ui(n.visibleWrites,t);var n}function bi(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){var a;if(null!=(t=ui(e=hi(e.visibleWrites,t),xt())))a=t;else{if(null==n)return[];a=di(e,n)}if((a=a.withIndex(s)).isEmpty()||a.isLeafNode())return[];for(var u=[],l=s.getCompare(),h=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),c=h.getNext();c&&u.length<i;)0!==l(c,r)&&u.push(c),c=h.getNext();return u}(e.writeTree,e.treePath,t,n,r,i,o)}function Ei(e,t,n){return r=e.writeTree,i=e.treePath,e=n,t=Ft(i,n=t),null!=(i=ui(r.visibleWrites,t))?i:e.isCompleteForChild(n)?di(hi(r.visibleWrites,t),e.getNode().getImmediateChild(n)):null;var r,i}function Ii(e,t){return Si(Ft(e.treePath,t),e.writeTree)}function Si(e,t){return{treePath:e,writeTree:t}}var Ti=(Pi.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;f("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),f(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,sr(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,or(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ir(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw _("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,sr(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},Pi.prototype.getChanges=function(){return Array.from(this.changeMap.values())},Pi);function Pi(){this.changeMap=new Map}function Ni(){}var Ri=new(Ni.prototype.getCompleteChild=function(e){return null},Ni.prototype.getChildAfterChild=function(e,t,n){return null},Ni),xi=(ki.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;return t.isCompleteForChild(e)?t.getNode().getImmediateChild(e):(t=null!=this.optCompleteServerCache_?new Br(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache,Ei(this.writes_,e,t))},ki.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Zr(this.viewCache_);return 0===(e=bi(this.writes_,r,t,1,n,e)).length?null:e[0]},ki);function ki(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}function Di(e,t,n,r,i){var o,s,a,u,l,h,c,d,p=new Ti;if(n.type===Rr.OVERWRITE)var y=n,v=y.source.fromUser?Li(e,t,y.path,y.snap,r,i,p):(f(y.source.fromServer,"Unknown source."),o=y.source.tagged||t.serverCache.isFiltered()&&!qt(y.path),Ai(e,t,y.path,y.snap,r,i,o,p));else if(n.type===Rr.MERGE){var g=n;v=g.source.fromUser?(s=e,a=t,u=g.path,y=g.children,l=r,h=i,c=p,d=a,y.foreach((function(e,t){e=Ft(u,e),Mi(a,kt(e))&&(d=Li(s,d,e,t,l,h,c))})),y.foreach((function(e,t){e=Ft(u,e),Mi(a,kt(e))||(d=Li(s,d,e,t,l,h,c))})),d):(f(g.source.fromServer,"Unknown source."),o=g.source.tagged||t.serverCache.isFiltered(),qi(e,t,g.path,g.children,r,i,o,p))}else if(n.type===Rr.ACK_USER_WRITE){var m=n;v=m.revert?function(e,t,n,r,i,o){var s;if(null!=Ci(r,n))return t;var a,u,l=new xi(r,t,i),h=t.eventCache.getNode();return i=void 0,qt(n)||".priority"===kt(n)?(u=void 0,u=t.serverCache.isFullyInitialized()?gi(r,Zr(t)):(a=t.serverCache.getNode(),f(a instanceof Wn,"serverChildren would be complete if leaf node"),mi(r,a)),i=e.filter.updateFullNode(h,u,o)):(null==(u=Ei(r,a=kt(n),t.serverCache))&&t.serverCache.isCompleteForChild(a)&&(u=h.getImmediateChild(a)),(i=null!=u?e.filter.updateChild(h,a,u,Ot(n),l,o):t.eventCache.getNode().hasChild(a)?e.filter.updateChild(h,a,Wn.EMPTY_NODE,Ot(n),l,o):h).isEmpty()&&t.serverCache.isFullyInitialized()&&(s=gi(r,Zr(t))).isLeafNode()&&(i=e.filter.updateFullNode(i,s,o))),s=t.serverCache.isFullyInitialized()||null!=Ci(r,xt()),$r(t,i,s,e.filter.filtersNodes())}(e,t,m.path,r,i,p):function(e,t,n,r,i,o,s){if(null!=Ci(i,n))return t;var a=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(qt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Ai(e,t,n,u.getNode().getChild(n),i,o,a,s);if(qt(n)){var l=new ei(null);return u.getNode().forEachChild(un,(function(e,t){l=l.set(new Nt(e),t)})),qi(e,t,n,l,i,o,a,s)}return t}var h=new ei(null);return r.foreach((function(e,t){var r=Ft(n,e);u.isCompleteForPath(r)&&(h=h.set(e,u.getNode().getChild(r)))})),qi(e,t,n,h,i,o,a,s)}(e,t,m.path,m.affectedTree,r,i,p)}else{if(n.type!==Rr.LISTEN_COMPLETE)throw _("Unknown operation type: "+n.type);o=e,m=t,i=n.path,e=r,n=p,v=Oi(o,r=Jr(m,(r=m.serverCache).getNode(),r.isFullyInitialized()||qt(i),r.isFiltered()),i,e,Ri,n)}return function(e,t,n){var r,i,o=t.eventCache;o.isFullyInitialized()&&(r=o.getNode().isLeafNode()||o.getNode().isEmpty(),i=Xr(e),(0<n.length||!e.eventCache.isFullyInitialized()||r&&!o.getNode().equals(i)||!o.getNode().getPriority().equals(i.getPriority()))&&n.push(rr(Xr(t))))}(t,v,p=p.getChanges()),{viewCache:v,changes:p}}function Oi(e,t,n,r,i,o){var s=t.eventCache;if(null!=Ci(r,n))return t;var a,u,l,h,c=void 0,d=void 0;return c=qt(n)?(f(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()?(a=mi(r,(a=Zr(t))instanceof Wn?a:Wn.EMPTY_NODE),e.filter.updateFullNode(t.eventCache.getNode(),a,o)):(u=gi(r,Zr(t)),e.filter.updateFullNode(t.eventCache.getNode(),u,o))):".priority"===(u=kt(n))?(f(1===Dt(n),"Can't have a priority with additional path components"),null!=(h=wi(r,n,l=s.getNode(),d=t.serverCache.getNode()))?e.filter.updatePriority(l,h):s.getNode()):(l=Ot(n),h=void 0,null!=(h=s.isCompleteForChild(u)?(d=t.serverCache.getNode(),null!=(d=wi(r,n,s.getNode(),d))?s.getNode().getImmediateChild(u).updateChild(l,d):s.getNode().getImmediateChild(u)):Ei(r,u,t.serverCache))?e.filter.updateChild(s.getNode(),u,h,l,i,o):s.getNode()),$r(t,c,s.isFullyInitialized()||qt(n),e.filter.filtersNodes())}function Ai(e,t,n,r,i,o,s,a){var u=t.serverCache,l=s?e.filter:e.filter.getIndexedFilter();if(qt(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered())var h=u.getNode().updateChild(n,r),c=l.updateFullNode(u.getNode(),h,null);else{if(s=kt(n),!u.isCompleteForPath(n)&&1<Dt(n))return t;h=Ot(n),r=u.getNode().getImmediateChild(s).updateChild(h,r),c=".priority"===s?l.updatePriority(u.getNode(),r):l.updateChild(u.getNode(),s,r,h,Ri,null)}return Oi(e,l=Jr(t,c,u.isFullyInitialized()||qt(n),l.filtersNodes()),n,i,new xi(i,l,o),a)}function Li(e,t,n,r,i,o,s){var a,u,l=t.eventCache,h=new xi(i,t,o);return qt(n)?(u=e.filter.updateFullNode(t.eventCache.getNode(),r,s),$r(t,u,!0,e.filter.filtersNodes())):".priority"===(a=kt(n))?(u=e.filter.updatePriority(t.eventCache.getNode(),r),$r(t,u,l.isFullyInitialized(),l.isFiltered())):(i=Ot(n),o=l.getNode().getImmediateChild(a),u=void 0,u=qt(i)?r:null!=(n=h.getCompleteChild(a))?".priority"===At(i)&&n.getChild(Mt(i)).isEmpty()?n:n.updateChild(i,r):Wn.EMPTY_NODE,o.equals(u)?t:$r(t,e.filter.updateChild(l.getNode(),a,u,i,h,s),l.isFullyInitialized(),e.filter.filtersNodes()))}function Mi(e,t){return e.eventCache.isCompleteForChild(t)}function Fi(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function qi(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u=t,l=(r=qt(n)?r:new ei(null).setTree(n,r),t.serverCache.getNode());return r.children.inorderTraversal((function(n,r){l.hasChild(n)&&(r=Fi(0,t.serverCache.getNode().getImmediateChild(n),r),u=Ai(e,u,new Nt(n),r,i,o,s,a))})),r.children.inorderTraversal((function(n,r){var h=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;l.hasChild(n)||h||(r=Fi(0,t.serverCache.getNode().getImmediateChild(n),r),u=Ai(e,u,new Nt(n),r,i,o,s,a))})),u}var Wi,Qi=(Object.defineProperty(ji.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),ji);function ji(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new ar(n.getIndex()),i=(o=n).loadsAllData()?new ar(o.getIndex()):new(o.hasLimit()?cr:lr)(o);this.processor_={filter:i},e=t.serverCache,n=t.eventCache;var o=r.updateFullNode(Wn.EMPTY_NODE,e.getNode(),null);t=i.updateFullNode(Wn.EMPTY_NODE,n.getNode(),null),r=new Br(o,e.isFullyInitialized(),r.filtersNodes()),i=new Br(t,n.isFullyInitialized(),i.filtersNodes()),this.viewCache_=Gr(i,r),this.eventGenerator_=new zr(this.query_)}function Ui(e){return 0===e.eventRegistrations_.length}function Bi(e,t,n){var r,i=[];if(n&&(f(null==t,"A cancel should cancel all event registrations."),r=e.query.path,e.eventRegistrations_.forEach((function(e){(e=e.createCancelEvent(n,r))&&i.push(e)}))),t){for(var o=[],s=0;s<e.eventRegistrations_.length;++s){var a=e.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){o=o.concat(e.eventRegistrations_.slice(s+1));break}}else o.push(a)}e.eventRegistrations_=o}else e.eventRegistrations_=[];return i}function Hi(e,t,n,r){t.type===Rr.MERGE&&null!==t.source.queryId&&(f(Zr(e.viewCache_),"We should always have a full cache before handling merges"),f(Xr(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_;return t=Di(e.processor_,i,t,n,r),n=e.processor_,r=t.viewCache,f(r.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),f(r.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed"),f(t.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=t.viewCache,Vi(e,t.changes,t.viewCache.eventCache.getNode(),null)}function Vi(e,t,n,r){return r=r?[r]:e.eventRegistrations_,Kr(e.eventGenerator_,t,n,r)}var zi=function(){this.views=new Map};function Ki(e,t,n,r){var i,o,s=t.source.queryId;if(null!==s){var a=e.views.get(s);return f(null!=a,"SyncTree gave us an op for an invalid query."),Hi(a,t,n,r)}var l=[];try{for(var h=u(e.views.values()),c=h.next();!c.done;c=h.next())a=c.value,l=l.concat(Hi(a,t,n,r))}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}return l}function Yi(e,t,n,r,i){var o=t.queryIdentifier();return(e=e.views.get(o))?e:(e=!1,e=!!(o=gi(n,i?r:null))||(o=r instanceof Wn?mi(n,r):Wn.EMPTY_NODE,!1),i=Gr(new Br(o,e,!1),new Br(r,i,!1)),new Qi(t,i))}function Gi(e,t,n,r,i,o){var s;return o=Yi(e,t,r,i,o),e.views.has(t.queryIdentifier())||e.views.set(t.queryIdentifier(),o),t=n,o.eventRegistrations_.push(t),t=n,o=(n=o).viewCache_.eventCache,s=[],o.getNode().isLeafNode()||o.getNode().forEachChild(Nn,(function(e,t){s.push(ir(e,t))})),o.isFullyInitialized()&&s.push(rr(o.getNode())),Vi(n,s,o.getNode(),t)}function $i(e,t,n,r){var i,o,s=t.queryIdentifier(),a=[],h=[],c=to(e);if("default"===s)try{for(var d=u(e.views.entries()),p=d.next();!p.done;p=d.next()){var _=l(p.value,2),y=_[0],v=_[1];h=h.concat(Bi(v,n,r)),Ui(v)&&(e.views.delete(y),v.query.getQueryParams().loadsAllData()||a.push(v.query))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}else(v=e.views.get(s))&&(h=h.concat(Bi(v,n,r)),Ui(v)&&(e.views.delete(s),v.query.getQueryParams().loadsAllData()||a.push(v.query)));return c&&!to(e)&&a.push((f(Wi,"Reference.ts has not been loaded"),new Wi(t.database,t.path))),{removed:a,events:h}}function Ji(e){var t,n,r=[];try{for(var i=u(e.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query.getQueryParams().loadsAllData()||r.push(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Xi(e,t){var n,r,i,o,s=null;try{for(var a=u(e.views.values()),l=a.next();!l.done;l=a.next()){var h=l.value;s=s||(i=t,o=void 0,(o=Zr((h=h).viewCache_))&&(h.query.getQueryParams().loadsAllData()||!qt(i)&&!o.getImmediateChild(kt(i)).isEmpty())?o.getChild(i):null)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function Zi(e,t){return t.getQueryParams().loadsAllData()?no(e):(t=t.queryIdentifier(),e.views.get(t))}function eo(e,t){return null!=Zi(e,t)}function to(e){return null!=no(e)}function no(e){var t,n;try{for(var r=u(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query.getQueryParams().loadsAllData())return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}var ro=1,io=function(e){this.listenProvider_=e,this.syncPointTree_=new ei(null),this.pendingWriteTree_={visibleWrites:ni.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function oo(e,t,n,r,i){var o,s,a,u;return o=e.pendingWriteTree_,s=t,a=n,u=i,f((r=r)>o.lastWriteId,"Stacking an older write on top of newer ones"),void 0===u&&(u=!0),o.allWrites.push({path:s,snap:a,writeId:r,visible:u}),u&&(o.visibleWrites=ii(o.visibleWrites,s,a)),o.lastWriteId=r,i?fo(e,new Wr(Dr(),t,n)):[]}function so(e,t,n,r){var i,o,s;return i=e.pendingWriteTree_,o=t,s=n,f((r=r)>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:o,children:s,writeId:r,visible:!0}),i.visibleWrites=oi(i.visibleWrites,o,s),i.lastWriteId=r,n=ei.fromObject(n),fo(e,new jr(Dr(),t,n))}function ao(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(fi(e.pendingWriteTree_,t)){var i=new ei(null);return null!=r.snap?i=i.set(xt(),!0):De(r.children,(function(e){i=i.set(new Nt(e),!0)})),fo(e,new Lr(r.path,i,n))}return[]}function uo(e,t,n){return fo(e,new Wr(Or(),t,n))}function lo(e,t,n,r){var i=t.path,o=e.syncPointTree_.get(i),s=[];if(o&&("default"===t.queryIdentifier()||eo(o,t))){var a=$i(o,t,n,r);if(0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i)),n=a.removed,s=a.events,o=-1!==n.findIndex((function(e){return e.getQueryParams().loadsAllData()})),a=e.syncPointTree_.findOnPath(i,(function(e,t){return to(t)})),o&&!a&&!(i=e.syncPointTree_.subtree(i)).isEmpty())for(var u=i.fold((function(e,t,n){if(t&&to(t))return[no(t)];var r=[];return t&&(r=Ji(t)),De(n,(function(e,t){r=r.concat(t)})),r})),l=0;l<u.length;++l){var h=(c=u[l]).query,c=yo(e,c);e.listenProvider_.startListening(bo(h),vo(e,h),c.hashFn,c.onComplete)}!a&&0<n.length&&!r&&(o?e.listenProvider_.stopListening(bo(t),null):n.forEach((function(t){var n=e.queryToTagMap.get(go(t));e.listenProvider_.stopListening(bo(t),n)}))),function(e,t){for(var n=0;n<t.length;++n){var r,i=t[n];i.getQueryParams().loadsAllData()||(r=go(i),i=e.queryToTagMap.get(r),e.queryToTagMap.delete(r),e.tagToQueryMap.delete(i))}}(e,n)}return s}function ho(e,t,n){var r=t.path,i=null,o=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){e=Wt(e,r),i=i||Xi(t,e),o=o||to(t)}));var s=e.syncPointTree_.get(r);s?(o=o||to(s),i=i||Xi(s,xt())):(s=new zi,e.syncPointTree_=e.syncPointTree_.set(r,s)),null!=i?h=!0:(h=!1,i=Wn.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((function(e,t){(t=Xi(t,xt()))&&(i=i.updateImmediateChild(e,t))})));var a,u,l=eo(s,t);l||t.getQueryParams().loadsAllData()||(a=go(t),f(!e.queryToTagMap.has(a),"View does not exist, but we have a tag"),u=ro++,e.queryToTagMap.set(a,u),e.tagToQueryMap.set(u,a));var h=Gi(s,t,n,pi(e.pendingWriteTree_,r),i,h);return l||o||(s=Zi(s,t),h=h.concat(function(e,t,n){var r=t.path,i=vo(e,t);if(n=yo(e,n),n=e.listenProvider_.startListening(bo(t),i,n.hashFn,n.onComplete),r=e.syncPointTree_.subtree(r),i)f(!to(r.value),"If we're adding a query, it shouldn't be shadowed");else for(var o=r.fold((function(e,t,n){if(!qt(e)&&t&&to(t))return[no(t).query];var r=[];return t&&(r=r.concat(Ji(t).map((function(e){return e.query})))),De(n,(function(e,t){r=r.concat(t)})),r})),s=0;s<o.length;++s){var a=o[s];e.listenProvider_.stopListening(bo(a),vo(e,a))}return n}(e,t,s))),h}function co(e,t,n){var r=e.pendingWriteTree_;return e=e.syncPointTree_.findOnPath(t,(function(e,n){if(e=Xi(n,Wt(e,t)))return e})),vi(r,t,e,n,!0)}function po(e,t){var n=t.path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){e=Wt(e,n),r=r||Xi(t,e)}));var i=e.syncPointTree_.get(n);i?r=r||Xi(i,xt()):(i=new zi,e.syncPointTree_=e.syncPointTree_.set(n,i));var o,s=(o=null!=r)?new Br(r,!0,!1):null;return Xr((o=Yi(i,t,pi(e.pendingWriteTree_,t.path),o?s.getNode():Wn.EMPTY_NODE,o)).viewCache_)}function fo(e,t){return function e(t,n,r,i){if(qt(t.path))return _o(t,n,r,i);var o=n.get(xt());null==r&&null!=o&&(r=Xi(o,xt()));var s=[],a=kt(t.path),u=t.operationForChild(a),l=n.children.get(a);return l&&u&&(n=r?r.getImmediateChild(a):null,a=Ii(i,a),s=s.concat(e(u,l,n,a))),o?s.concat(Ki(o,t,i,r)):s}(t,e.syncPointTree_,null,pi(e.pendingWriteTree_,xt()))}function _o(e,t,n,r){var i=t.get(xt());null==n&&null!=i&&(n=Xi(i,xt()));var o=[];return t.children.inorderTraversal((function(t,i){var s=n?n.getImmediateChild(t):null,a=Ii(r,t);(t=e.operationForChild(t))&&(o=o.concat(_o(t,i,s,a)))})),o=i?o.concat(Ki(i,e,r,n)):o}function yo(e,t){var n=t.query,r=vo(e,n);return{hashFn:function(){return(t.viewCache_.serverCache.getNode()||Wn.EMPTY_NODE).hash()},onComplete:function(t){return"ok"===t?r?function(e,t,n){var r=mo(e,n);return r?(r=(n=wo(r)).path,n=n.queryId,t=Wt(r,t),Co(e,r,new Fr(Ar(n),t))):[]}(e,n.path,r):(i=e,o=n.path,fo(i,new Fr(Or(),o))):(t=Le(t,n),lo(e,n,null,t));var i,o}}}function vo(e,t){return t=go(t),e.queryToTagMap.get(t)}function go(e){return e.path.toString()+"$"+e.queryIdentifier()}function mo(e,t){return e.tagToQueryMap.get(t)}function wo(e){var t=e.indexOf("$");return f(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Nt(e.substr(0,t))}}function Co(e,t,n){var r=e.syncPointTree_.get(t);return f(r,"Missing sync point for query tag that we're tracking"),Ki(r,n,pi(e.pendingWriteTree_,t),null)}function bo(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e}var Eo=(Io.prototype.getImmediateChild=function(e){return new Io(this.node_.getImmediateChild(e))},Io.prototype.node=function(){return this.node_},Io);function Io(e){this.node_=e}var So=(To.prototype.getImmediateChild=function(e){return e=Ft(this.path_,e),new To(this.syncTree_,e)},To.prototype.node=function(){return co(this.syncTree_,this.path_)},To);function To(e,t){this.syncTree_=e,this.path_=t}var Po=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},No=function(e,t,n){return e&&"object"==typeof e?(f(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Ro(e[".sv"],t,n):"object"==typeof e[".sv"]?xo(e[".sv"],t):void f(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Ro=function(e,t,n){if("timestamp"===e)return n.timestamp;f(!1,"Unexpected server value: "+e)},xo=function(e,t,n){return e.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(e,null,2)),"number"!=typeof(e=e.increment)&&f(!1,"Unexpected increment value: "+e),t=t.node(),f(null!=t,"Expected ChildrenNode.EMPTY_NODE for nulls"),t.isLeafNode()?"number"!=typeof(t=t.getValue())?e:t+e:e},ko=function(e,t,n,r){return Oo(t,new So(n,e),r)},Do=function(e,t,n){return Oo(e,new Eo(t),n)};function Oo(e,t,n){var r=e.getPriority().val(),i=No(r,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e;return(r=No(o.getValue(),t,n))!==o.getValue()||i!==o.getPriority().val()?new Sn(r,Hn(i)):e}var s=e=e;return i!==e.getPriority().val()&&(s=s.updatePriority(new Sn(i))),e.forEachChild(Nn,(function(e,r){var i=Oo(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}var Ao=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n};function Lo(e,t){for(var n=t instanceof Nt?t:new Nt(t),r=e,i=kt(n);null!==i;){var o=A(r.node.children,i)||{children:{},childCount:0};r=new Ao(i,r,o),i=kt(n=Ot(n))}return r}function Mo(e){return e.node.value}function Fo(e,t){e.node.value=t,jo(e)}function qo(e){return 0<e.node.childCount}function Wo(e,t){De(e.node.children,(function(n,r){t(new Ao(n,e,r))}))}function Qo(e){return new Nt(null===e.parent?e.name:Qo(e.parent)+"/"+e.name)}function jo(e){var t,n,r,i;null!==e.parent&&(t=e.parent,n=e.name,i=function(e){return void 0===Mo(e)&&!qo(e)}(r=e),e=O(t.node.children,n),i&&e?(delete t.node.children[n],t.node.childCount--,jo(t)):i||e||(t.node.children[n]=r.node,t.node.childCount++,jo(t)))}function Uo(e){return"string"==typeof e&&0!==e.length&&!Xo.test(e)}function Bo(e){return"string"==typeof e&&0!==e.length&&!Zo.test(e)}function Ho(e){return null===e||"string"==typeof e||"number"==typeof e&&!de(e)||e&&"object"==typeof e&&O(e,".sv")}function Vo(e,t,n,r,i){i&&void 0===n||ts(j(e,t,i),n,r)}function zo(e,t,n,r,i){if(!i||void 0!==n){var o=j(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var s=[];De(n,(function(e,t){if(e=new Nt(e),ts(o,t,Ft(r,e)),".priority"===At(e)&&!Ho(t))throw new Error(o+"contains an invalid value for '"+e.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(e)})),function(e,t){for(var n=0;n<t.length;n++)for(var r,i=Lt(r=t[n]),o=0;o<i.length;o++)if((".priority"!==i[o]||o!==i.length-1)&&!Uo(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Qt);var s=null;for(n=0;n<t.length;n++){if(r=t[n],null!==s&&Ut(s,r))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,s)}}function Ko(e,t,n,r){if(!r||void 0!==n){if(de(n))throw new Error(j(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ho(n))throw new Error(j(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function Yo(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(j(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function Go(e,t,n,r){if(!(r&&void 0===n||Uo(n)))throw new Error(j(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function $o(e,t,n,r){if(!(r&&void 0===n||Bo(n)))throw new Error(j(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function Jo(e,t){if(".info"===kt(t))throw new Error(e+" failed = Can't modify data under /.info/")}var Xo=/[\[\].#$\/\u0000-\u001F\u007F]/,Zo=/[\[\].#$\u0000-\u001F\u007F]/,es=10485760,ts=function e(t,n,r){var i=r instanceof Nt?new Bt(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+Vt(i));if("function"==typeof n)throw new Error(t+"contains a function "+Vt(i)+" with contents = "+n.toString());if(de(n))throw new Error(t+"contains "+n.toString()+" "+Vt(i));if("string"==typeof n&&n.length>es/3&&H(n)>es)throw new Error(t+"contains a string greater than "+es+" utf8 bytes "+Vt(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var o=!1,s=!1;if(De(n,(function(n,r){if(".value"===n)o=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!Uo(n)))throw new Error(t+" contains an invalid key ("+n+") "+Vt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a;a=n,0<(n=i).parts_.length&&(n.byteLength_+=1),n.parts_.push(a),n.byteLength_+=H(a),Ht(n),e(t,r,i),r=(n=i).parts_.pop(),n.byteLength_-=H(r),0<n.parts_.length&&--n.byteLength_})),o&&s)throw new Error(t+' contains ".value" child '+Vt(i)+" in addition to actual children.")}},ns=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Uo(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!Bo(r=(r=r)&&r.replace(/^\/*\.info(\/|$)/,"/")))throw new Error(j(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},rs=function(){this.eventLists_=[],this.recursionDepth_=0};function is(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||jt(o,n.path)||(e.eventLists_.push(n),n=null),(n=null===n?{events:[],path:o}:n).events.push(i)}n&&e.eventLists_.push(n)}function os(e,t,n){is(e,n),as(e,(function(e){return jt(e,t)}))}function ss(e,t,n){is(e,n),as(e,(function(e){return Ut(e,t)||Ut(t,e)}))}function as(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(function(e){for(var t=0;t<e.events.length;t++){var n,r=e.events[t];null!==r&&(e.events[t]=null,n=r.getEventRunner(),be&&Ie("event: "+r.toString()),Qe(n))}}(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}var us="repo_interrupt",ls=25,hs=(cs.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},cs);function cs(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ir(),this.transactionQueueTree_=new Ao,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}function ds(e){if(e.stats_=tt(e.repoInfo_),e.forceRestClient_||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))e.server_=new wr(e.repoInfo_,(function(t,n,r,i){_s(e,t,n,r,i)}),e.authTokenProvider_),setTimeout((function(){return ys(e,!0)}),0);else{var t=e.app.options.databaseAuthVariableOverride;if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{k(t)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}e.persistentConnection_=new Xt(e.repoInfo_,e.app.options.appId,(function(t,n,r,i){_s(e,t,n,r,i)}),(function(t){ys(e,t)}),(function(t){var n;n=e,De(t,(function(e,t){vs(n,e,t)}))}),e.authTokenProvider_,t),e.server_=e.persistentConnection_}var n,r;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.statsReporter_=(r=function(){return new xr(e.stats_,e.server_)},n=(n=e.repoInfo_).toString(),et[n]||(et[n]=r()),et[n]),e.infoData_=new br,e.infoSyncTree_=new io({startListening:function(t,n,r,i){var o=[],s=e.infoData_.getNode(t.path);return s.isEmpty()||(o=uo(e.infoSyncTree_,t.path,s),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),vs(e,"connected",!1),e.serverSyncTree_=new io({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){r=i(n,r),ss(e.eventQueue_,t.path,r)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function ps(e){return e=e.infoData_.getNode(new Nt(".info/serverTimeOffset")).val()||0,(new Date).getTime()+e}function fs(e){return Po({timestamp:ps(e)})}function _s(e,t,n,r,i){e.dataUpdateCount++;var o=new Nt(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var s,a,u,l=[],h=o;0<(l=i?r?(s=M(n,(function(e){return Hn(e)})),function(e,t,n,r){var i=mo(e,r);return i?(i=(r=wo(i)).path,r=r.queryId,t=Wt(i,t),n=ei.fromObject(n),Co(e,i,new jr(Ar(r),t,n))):[]}(e.serverSyncTree_,o,s,i)):(t=Hn(n),s=e.serverSyncTree_,a=o,u=t,null==(i=mo(s,t=i))?[]:(t=wo(i),i=t.path,t=t.queryId,a=Wt(i,a),Co(s,i,new Wr(Ar(t),a,u)))):r?(a=M(n,(function(e){return Hn(e)})),u=e.serverSyncTree_,r=o,a=a,a=ei.fromObject(a),fo(u,new jr(Or(),r,a))):(n=Hn(n),uo(e.serverSyncTree_,o,n))).length&&(h=Ns(e,o)),ss(e.eventQueue_,h,l)}function ys(e,t){vs(e,"connected",t),!1===t&&function(e){Is(e,"onDisconnectEvents");var t=fs(e),n=Ir();Tr(e.onDisconnect_,xt(),(function(r,i){i=ko(r,i,e.serverSyncTree_,t),Sr(n,r,i)}));var r=[];Tr(n,xt(),(function(t,n){r=r.concat(uo(e.serverSyncTree_,t,n)),t=Ds(e,t),Ns(e,t)})),e.onDisconnect_=Ir(),ss(e.eventQueue_,xt(),r)}(e)}function vs(e,t,n){t=new Nt("/.info/"+t),n=Hn(n),e.infoData_.updateSnapshot(t,n),n=uo(e.infoSyncTree_,t,n),ss(e.eventQueue_,t,n)}function gs(e){return e.nextWriteId_++}function ms(e,t,n,r,i){Is(e,"set",{path:t.toString(),value:n,priority:r});var o=fs(e),s=(n=Hn(n,r),r=co(e.serverSyncTree_,t),o=Do(n,r,o),gs(e));o=oo(e.serverSyncTree_,t,o,s,!0),is(e.eventQueue_,o),e.server_.put(t.toString(),n.val(!0),(function(n,r){var o="ok"===n;o||Pe("set at "+t+" failed: "+n),o=ao(e.serverSyncTree_,s,!o),ss(e.eventQueue_,t,o),Ss(0,i,n,r)})),n=Ds(e,t),Ns(e,n),ss(e.eventQueue_,n,[])}function ws(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&function e(t,n){if(qt(n))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var r=t.value;return t.value=null,r.forEachChild(Nn,(function(e,n){Sr(t,new Nt(e),n)})),e(t,n)}return!(0<t.children.size)||(r=kt(n),n=Ot(n),t.children.has(r)&&e(t.children.get(r),n)&&t.children.delete(r),0===t.children.size)}(e.onDisconnect_,t),Ss(0,n,r,i)}))}function Cs(e,t,n,r){var i=Hn(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,o){"ok"===n&&Sr(e.onDisconnect_,t,i),Ss(0,r,n,o)}))}function bs(e,t,n){n=".info"===kt(t.path)?ho(e.infoSyncTree_,t,n):ho(e.serverSyncTree_,t,n),os(e.eventQueue_,t.path,n)}function Es(e){e.persistentConnection_&&e.persistentConnection_.interrupt(us)}function Is(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),Ie.apply(void 0,h([r],l(t)))}function Ss(e,t,n,r){t&&Qe((function(){var e,i;"ok"===n?t(null):(i=e=(n||"error").toUpperCase(),r&&(i+=": "+r),(i=new Error(i)).code=e,t(i))}))}function Ts(e,t,n){return co(e.serverSyncTree_,t,n)||Wn.EMPTY_NODE}function Ps(e,t){var n;(t=void 0===t?e.transactionQueueTree_:t)||ks(e,t),Mo(t)?(n=xs(e,t),f(0<n.length,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=u=Ts(e,t,r),o=(r=u.hash(),0);o<n.length;o++){var s=n[o];f(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;var a=Wt(t,s.path);i=i.updateChild(a,s.currentOutputSnapshotRaw)}var u=i.val(!0),l=t;e.server_.put(l.toString(),u,(function(r){Is(e,"transaction put response",{path:l.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<n.length;s++)!function(t){n[t].status=2,i=i.concat(ao(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()}(s);for(ks(e,Lo(e.transactionQueueTree_,t)),Ps(e,e.transactionQueueTree_),ss(e.eventQueue_,t,i),s=0;s<o.length;s++)Qe(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else for(Pe("transaction at "+l.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;Ns(e,t)}}),r)}(e,Qo(t),n)):qo(t)&&Wo(t,(function(t){Ps(e,t)}))}function Ns(e,t){var n=Rs(e,t);return t=Qo(n),function(e,t,n){if(0!==t.length){for(var r=[],i=[],o=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),s=0;s<t.length;s++)!function(s){var a,u,l,h,c=t[s],d=Wt(n,c.path),p=!1;f(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status?(p=!0,a=c.abortReason,i=i.concat(ao(e.serverSyncTree_,c.currentWriteId,!0))):0===c.status&&(i=c.retryCount>=ls?(p=!0,a="maxretry",i.concat(ao(e.serverSyncTree_,c.currentWriteId,!0))):(u=Ts(e,c.path,o),c.currentInputSnapshot=u,void 0!==(h=t[s].update(u.val()))?(ts("transaction failed: Data returned ",h,c.path),l=Hn(h),"object"==typeof h&&null!=h&&O(h,".priority")||(l=l.updatePriority(u.getPriority())),d=c.currentWriteId,h=fs(e),h=Do(l,u,h),c.currentOutputSnapshotRaw=l,c.currentOutputSnapshotResolved=h,c.currentWriteId=gs(e),o.splice(o.indexOf(d),1),(i=i.concat(oo(e.serverSyncTree_,c.path,h,c.currentWriteId,c.applyLocally))).concat(ao(e.serverSyncTree_,d,!0))):(p=!0,a="nodata",i.concat(ao(e.serverSyncTree_,c.currentWriteId,!0))))),ss(e.eventQueue_,n,i),i=[],p&&(t[s].status=2,p=t[s].unwatcher,setTimeout(p,Math.floor(0)),t[s].onComplete&&("nodata"===a?r.push((function(){return t[s].onComplete(null,!1,t[s].currentInputSnapshot)})):r.push((function(){return t[s].onComplete(new Error(a),!1,null)}))))}(s);for(ks(e,e.transactionQueueTree_),s=0;s<r.length;s++)Qe(r[s]);Ps(e,e.transactionQueueTree_)}}(e,xs(e,n),t),t}function Rs(e,t){for(var n=e.transactionQueueTree_,r=kt(t);null!==r&&void 0===Mo(n);)n=Lo(n,r),r=kt(t=Ot(t));return n}function xs(e,t){var n=[];return function e(t,n,r){var i=Mo(n);if(i)for(var o=0;o<i.length;o++)r.push(i[o]);Wo(n,(function(n){e(t,n,r)}))}(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function ks(e,t){var n=Mo(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Fo(t,0<n.length?n:void 0)}Wo(t,(function(t){ks(e,t)}))}function Ds(e,t){var n=Qo(Rs(e,t));return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return;r=r.parent}}(t=Lo(e.transactionQueueTree_,t),(function(t){Os(e,t)})),Os(e,t),function e(t,n,r,i){r&&!i&&n(t),Wo(t,(function(t){e(t,n,!0,i)})),r&&i&&n(t)}(t,(function(t){Os(e,t)})),n}function Os(e,t){var n=Mo(t);if(n){for(var r=[],i=[],o=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(f(o===s-1,"All SENT items should be at beginning of queue."),n[o=s].status=3,n[s].abortReason="set"):(f(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(ao(e.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===o?Fo(t,void 0):n.length=o+1,ss(e.eventQueue_,Qo(t),i),s=0;s<r.length;s++)Qe(r[s])}}var As=function(e,t){var n=Ls(e),r=n.namespace;return"firebase.com"===n.domain&&Te(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Te("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Pe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),e="ws"===n.scheme||"wss"===n.scheme,{repoInfo:new Ye(n.host,n.secure,r,t,e,"",r!==n.subdomain),path:new Nt(n.pathString)}},Ls=function(e){var t,n,r,i="",o="",s="",a="",l="",h=!0,c="https",d=443;return"string"==typeof e&&(0<=(r=e.indexOf("//"))&&(c=e.substring(0,r-1),e=e.substring(r+2)),-1===(t=e.indexOf("/"))&&(t=e.length),-1===(n=e.indexOf("?"))&&(n=e.length),i=e.substring(0,Math.min(t,n)),t<n&&(a=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(t,n))),n=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=u(e.split("&")),o=i.next();!o.done;o=i.next()){var s,a=o.value;0!==a.length&&(2===(s=a.split("=")).length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Pe("Invalid query segment '"+a+"' in query '"+e+"'"))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,n))),0<=(r=i.indexOf(":"))?(h="https"===c||"wss"===c,d=parseInt(i.substring(r+1),10)):r=i.length,"localhost"===(r=i.slice(0,r)).toLowerCase()?o="localhost":r.split(".").length<=2?o=r:(r=i.indexOf("."),s=i.substring(0,r).toLowerCase(),o=i.substring(r+1),l=s),"ns"in n&&(l=n.ns)),{host:i,port:d,domain:o,subdomain:s,secure:h,scheme:c,pathString:a,namespace:l}},Ms=(Fs.prototype.val=function(){return Q("DataSnapshot.val",0,0,arguments.length),this.node_.val()},Fs.prototype.exportVal=function(){return Q("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},Fs.prototype.toJSON=function(){return Q("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},Fs.prototype.exists=function(){return Q("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},Fs.prototype.child=function(e){Q("DataSnapshot.child",0,1,arguments.length),$o("DataSnapshot.child",1,e=String(e),!1);var t=new Nt(e);return e=this.ref_.child(t),new Fs(this.node_.getChild(t),e,Nn)},Fs.prototype.hasChild=function(e){return Q("DataSnapshot.hasChild",1,1,arguments.length),$o("DataSnapshot.hasChild",1,e,!1),e=new Nt(e),!this.node_.getChild(e).isEmpty()},Fs.prototype.getPriority=function(){return Q("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},Fs.prototype.forEach=function(e){var t=this;return Q("DataSnapshot.forEach",1,1,arguments.length),U("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,(function(n,r){return e(new Fs(r,t.ref_.child(n),Nn))}))},Fs.prototype.hasChildren=function(){return Q("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(Fs.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),Fs.prototype.numChildren=function(){return Q("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},Fs.prototype.getRef=function(){return Q("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(Fs.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),Fs);function Fs(e,t,n){this.node_=e,this.ref_=t,this.index_=n}var qs=(Ws.prototype.cancel=function(e){Q("OnDisconnect.cancel",0,1,arguments.length),U("OnDisconnect.cancel",1,e,!0);var t=new m;return ws(this.repo_,this.path_,t.wrapCallback(e)),t.promise},Ws.prototype.remove=function(e){Q("OnDisconnect.remove",0,1,arguments.length),Jo("OnDisconnect.remove",this.path_),U("OnDisconnect.remove",1,e,!0);var t=new m;return Cs(this.repo_,this.path_,null,t.wrapCallback(e)),t.promise},Ws.prototype.set=function(e,t){Q("OnDisconnect.set",1,2,arguments.length),Jo("OnDisconnect.set",this.path_),Vo("OnDisconnect.set",1,e,this.path_,!1),U("OnDisconnect.set",2,t,!0);var n=new m;return Cs(this.repo_,this.path_,e,n.wrapCallback(t)),n.promise},Ws.prototype.setWithPriority=function(e,t,n){Q("OnDisconnect.setWithPriority",2,3,arguments.length),Jo("OnDisconnect.setWithPriority",this.path_),Vo("OnDisconnect.setWithPriority",1,e,this.path_,!1),Ko("OnDisconnect.setWithPriority",2,t,!1),U("OnDisconnect.setWithPriority",3,n,!0);var r,i,o,s,a=new m;return r=this.repo_,i=this.path_,e=e,t=t,o=a.wrapCallback(n),s=Hn(e,t),r.server_.onDisconnectPut(i.toString(),s.val(!0),(function(e,t){"ok"===e&&Sr(r.onDisconnect_,i,s),Ss(0,o,e,t)})),a.promise},Ws.prototype.update=function(e,t){if(Q("OnDisconnect.update",1,2,arguments.length),Jo("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Pe("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}zo("OnDisconnect.update",1,e,this.path_,!1),U("OnDisconnect.update",2,t,!0);var i=new m;return function(e,t,n,r){if(L(n))return Ie("onDisconnect().update() called with empty data.  Don't do anything."),Ss(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,o){"ok"===i&&De(n,(function(n,r){r=Hn(r),Sr(e.onDisconnect_,Ft(t,n),r)})),Ss(0,r,i,o)}))}(this.repo_,this.path_,e,i.wrapCallback(t)),i.promise},Ws);function Ws(e,t){this.repo_=e,this.path_=t}var Qs=(js.prototype.getPath=function(){var e=this.snapshot.getRef();return("value"===this.eventType?e:e.getParent()).path},js.prototype.getEventType=function(){return this.eventType},js.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},js.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+k(this.snapshot.exportVal())},js);function js(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}var Us=(Bs.prototype.getPath=function(){return this.path},Bs.prototype.getEventType=function(){return"cancel"},Bs.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},Bs.prototype.toString=function(){return this.path.toString()+":cancel"},Bs);function Bs(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}var Hs=(Vs.prototype.respondsTo=function(e){return"value"===e},Vs.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new Qs("value",this,new Ms(e.snapshotNode,t.getRef(),n))},Vs.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){f(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},Vs.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Us(this,e,t):null},Vs.prototype.matches=function(e){return e instanceof Vs&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},Vs.prototype.hasAnyCallback=function(){return null!==this.callback_},Vs);function Vs(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}var zs,Ks=(Ys.prototype.respondsTo=function(e){return e="children_removed"===(e="children_added"===e?"child_added":e)?"child_removed":e,O(this.callbacks_,e)},Ys.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Us(this,e,t):null},Ys.prototype.createEvent=function(e,t){f(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName);return t=t.getQueryParams().getIndex(),new Qs(e.type,this,new Ms(e.snapshotNode,n,t),e.prevName)},Ys.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){f(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},Ys.prototype.matches=function(e){var t=this;if(e instanceof Ys){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=Object.keys(e.callbacks_),r=Object.keys(this.callbacks_),i=n.length;if(i===r.length)return 1!==i?r.every((function(n){return e.callbacks_[n]===t.callbacks_[n]})):(n=n[0],!((r=r[0])!==n||e.callbacks_[n]&&this.callbacks_[r]&&e.callbacks_[n]!==this.callbacks_[r]))}}return!1},Ys.prototype.hasAnyCallback=function(){return null!==this.callbacks_},Ys);function Ys(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}var Gs=(Object.defineProperty($s,"__referenceConstructor",{get:function(){return f(zs,"Reference.ts has not been loaded"),zs},set:function(e){zs=e},enumerable:!1,configurable:!0}),$s.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===un){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Ne)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Re)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Nn){if(null!=t&&!Ho(t)||null!=n&&!Ho(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(f(e.getIndex()instanceof Kn||e.getIndex()===er,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")},$s.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")},$s.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},$s.prototype.getQueryParams=function(){return this.queryParams_},$s.prototype.getRef=function(){return Q("Query.ref",0,0,arguments.length),new $s.__referenceConstructor(this.database,this.path)},$s.prototype.on=function(e,t,n,r){return Q("Query.on",2,4,arguments.length),Yo("Query.on",1,e,!1),U("Query.on",2,t,!1),n=$s.getCancelAndContextArgs_("Query.on",n,r),"value"===e?this.onValueEvent(t,n.cancel,n.context):((r={})[e]=t,this.onChildEvent(r,n.cancel,n.context)),t},$s.prototype.onValueEvent=function(e,t,n){n=new Hs(e,t||null,n||null),bs(this.repo,this,n)},$s.prototype.onChildEvent=function(e,t,n){n=new Ks(e,t,n),bs(this.repo,this,n)},$s.prototype.off=function(e,t,n){Q("Query.off",0,3,arguments.length),Yo("Query.off",1,e,!0),U("Query.off",2,t,!0),B("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new Hs(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new Ks(i,null,n||null)),i=this.repo,n=r,n=".info"===kt((r=this).path)?lo(i.infoSyncTree_,r,n):lo(i.serverSyncTree_,r,n),os(i.eventQueue_,r.path,n)},$s.prototype.get=function(){var e,t,n,r=this;return e=this.repo,t=this,(null!=(n=po(e.serverSyncTree_,t))?Promise.resolve(n):e.server_.get(t).then((function(n){var r=Hn(n);return n=uo(e.serverSyncTree_,t.path,r),os(e.eventQueue_,t.path,n),Promise.resolve(r)}),(function(n){return Is(e,"get for query "+k(t)+" failed: "+n),Promise.reject(new Error(n))}))).then((function(e){return new Ms(e,r.getRef(),r.getQueryParams().getIndex())}))},$s.prototype.once=function(e,t,n,r){var i=this;Q("Query.once",1,4,arguments.length),Yo("Query.once",1,e,!1),U("Query.once",2,t,!0);var o=$s.getCancelAndContextArgs_("Query.once",n,r),s=!0,a=new m;a.promise.catch((function(){}));var u=function n(r){s&&(s=!1,i.off(e,n),t&&t.bind(o.context)(r),a.resolve(r))};return this.on(e,u,(function(t){i.off(e,u),o.cancel&&o.cancel.bind(o.context)(t),a.reject(t)})),a.promise},$s.prototype.limitToFirst=function(e){if(Q("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new $s(this.database,this.path,(e=e,(t=(t=this.queryParams_).copy()).limitSet_=!0,t.limit_=e,t.viewFrom_="l",t),this.orderByCalled_);var t},$s.prototype.limitToLast=function(e){if(Q("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new $s(this.database,this.path,(e=e,(t=(t=this.queryParams_).copy()).limitSet_=!0,t.limit_=e,t.viewFrom_="r",t),this.orderByCalled_);var t},$s.prototype.orderByChild=function(e){if(Q("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');if($o("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild"),qt(e=new Nt(e)))throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");return e=new Kn(e),e=vr(this.queryParams_,e),$s.validateQueryEndpoints_(e),new $s(this.database,this.path,e,!0)},$s.prototype.orderByKey=function(){Q("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=vr(this.queryParams_,un);return $s.validateQueryEndpoints_(e),new $s(this.database,this.path,e,!0)},$s.prototype.orderByPriority=function(){Q("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=vr(this.queryParams_,Nn);return $s.validateQueryEndpoints_(e),new $s(this.database,this.path,e,!0)},$s.prototype.orderByValue=function(){Q("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=vr(this.queryParams_,er);return $s.validateQueryEndpoints_(e),new $s(this.database,this.path,e,!0)},$s.prototype.startAt=function(e,t){void 0===e&&(e=null),Q("Query.startAt",0,2,arguments.length),Vo("Query.startAt",1,e,this.path,!0),Go("Query.startAt",2,t,!0);var n=_r(this.queryParams_,e,t);if($s.validateLimit_(n),$s.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(t=e=null),new $s(this.database,this.path,n,this.orderByCalled_)},$s.prototype.startAfter=function(e,t){var n;if(void 0===e&&(e=null),Q("Query.startAfter",0,2,arguments.length),Vo("Query.startAfter",1,e,this.path,!1),Go("Query.startAfter",2,t,!0),e=e,t=t,(t=(n=this.queryParams_).index_===un?_r(n,e="string"==typeof e?$n(e):e,t):_r(n,e,null==t?Re:$n(t))).startAfterSet_=!0,t=t,$s.validateLimit_(t),$s.validateQueryEndpoints_(t),this.queryParams_.hasStart())throw new Error("Query.startAfter: Starting point was already set (by another call to startAt, startAfter or equalTo).");return new $s(this.database,this.path,t,this.orderByCalled_)},$s.prototype.endAt=function(e,t){if(void 0===e&&(e=null),Q("Query.endAt",0,2,arguments.length),Vo("Query.endAt",1,e,this.path,!0),Go("Query.endAt",2,t,!0),t=yr(this.queryParams_,e,t),$s.validateLimit_(t),$s.validateQueryEndpoints_(t),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new $s(this.database,this.path,t,this.orderByCalled_)},$s.prototype.endBefore=function(e,t){var n;if(void 0===e&&(e=null),Q("Query.endBefore",0,2,arguments.length),Vo("Query.endBefore",1,e,this.path,!1),Go("Query.endBefore",2,t,!0),e=e,t=t,(t=(n=this.queryParams_).index_===un?yr(n,e="string"==typeof e?Jn(e):e,t):yr(n,e,null==t?Ne:Jn(t))).endBeforeSet_=!0,t=t,$s.validateLimit_(t),$s.validateQueryEndpoints_(t),this.queryParams_.hasEnd())throw new Error("Query.endBefore: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new $s(this.database,this.path,t,this.orderByCalled_)},$s.prototype.equalTo=function(e,t){if(Q("Query.equalTo",1,2,arguments.length),Vo("Query.equalTo",1,e,this.path,!1),Go("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return this.startAt(e,t).endAt(e,t)},$s.prototype.toString=function(){return Q("Query.toString",0,0,arguments.length),this.repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this.path)},$s.prototype.toJSON=function(){return Q("Query.toJSON",0,1,arguments.length),this.toString()},$s.prototype.queryObject=function(){return n={},(e=this.queryParams_).startSet_&&(n.sp=e.indexStartValue_,e.startNameSet_&&(n.sn=e.indexStartName_)),e.endSet_&&(n.ep=e.indexEndValue_,e.endNameSet_&&(n.en=e.indexEndName_)),e.limitSet_&&(n.l=e.limit_,""===(t=e.viewFrom_)&&(t=e.isViewFromLeft()?"l":"r"),n.vf=t),e.index_!==Nn&&(n.i=e.index_.toString()),n;var e,t,n},$s.prototype.queryIdentifier=function(){var e=this.queryObject();return"{}"===(e=ke(e))?"default":e},$s.prototype.isEqual=function(e){if(Q("Query.isEqual",1,1,arguments.length),!(e instanceof $s))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var t=this.repo===e.repo,n=jt(this.path,e.path);return e=this.queryIdentifier()===e.queryIdentifier(),t&&n&&e},$s.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,U(e,3,r.cancel,!0),r.context=n,B(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(j(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty($s.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),$s);function $s(e,t,n,r){this.database=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r,this.repo=e.repo_}var Js=(Xs.prototype.toJSON=function(){return Q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},Xs);function Xs(e,t){this.committed=e,this.snapshot=t}var Zs,ea,ta=(i(na,Zs=Gs),na.prototype.getKey=function(){return Q("Reference.key",0,0,arguments.length),qt(this.path)?null:At(this.path)},na.prototype.child=function(e){var t,n,r;return Q("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof Nt||(null===kt(this.path)?(r=!(t=1),$o("Reference.child",t,n=(n=e)&&n.replace(/^\/*\.info(\/|$)/,"/"),r)):$o("Reference.child",1,e,!1)),new na(this.database,Ft(this.path,e))},na.prototype.getParent=function(){Q("Reference.parent",0,0,arguments.length);var e=Mt(this.path);return null===e?null:new na(this.database,e)},na.prototype.getRoot=function(){Q("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},na.prototype.set=function(e,t){Q("Reference.set",1,2,arguments.length),Jo("Reference.set",this.path),Vo("Reference.set",1,e,this.path,!1),U("Reference.set",2,t,!0);var n=new m;return ms(this.repo,this.path,e,null,n.wrapCallback(t)),n.promise},na.prototype.update=function(e,t){if(Q("Reference.update",1,2,arguments.length),Jo("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Pe("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}zo("Reference.update",1,e,this.path,!1),U("Reference.update",2,t,!0);var i=new m;return function(e,t,n,r){Is(e,"update",{path:t.toString(),value:n});var i,o,s=!0,a=fs(e),u={};De(n,(function(n,r){s=!1,u[n]=ko(Ft(t,n),Hn(r),e.serverSyncTree_,a)})),s?(Ie("update() called with empty data.  Don't do anything."),Ss(0,r,"ok",void 0)):(i=gs(e),o=so(e.serverSyncTree_,t,u,i),is(e.eventQueue_,o),e.server_.merge(t.toString(),n,(function(n,o){(a="ok"===n)||Pe("update at "+t+" failed: "+n);var s=ao(e.serverSyncTree_,i,!a),a=0<s.length?Ns(e,t):t;ss(e.eventQueue_,a,s),Ss(0,r,n,o)})),De(n,(function(n){n=Ds(e,Ft(t,n)),Ns(e,n)})),ss(e.eventQueue_,t,[]))}(this.repo,this.path,e,i.wrapCallback(t)),i.promise},na.prototype.setWithPriority=function(e,t,n){if(Q("Reference.setWithPriority",2,3,arguments.length),Jo("Reference.setWithPriority",this.path),Vo("Reference.setWithPriority",1,e,this.path,!1),Ko("Reference.setWithPriority",2,t,!1),U("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new m;return ms(this.repo,this.path,e,t,r.wrapCallback(n)),r.promise},na.prototype.remove=function(e){return Q("Reference.remove",0,1,arguments.length),Jo("Reference.remove",this.path),U("Reference.remove",1,e,!0),this.set(null,e)},na.prototype.transaction=function(e,t,n){var r=this;if(Q("Reference.transaction",1,3,arguments.length),Jo("Reference.transaction",this.path),U("Reference.transaction",1,e,!1),U("Reference.transaction",2,t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(j("Reference.transaction",3,r)+"must be a boolean.")}(0,0,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var i=new m;function o(){}"function"==typeof t&&i.promise.catch((function(){}));var s=new na(this.database,this.path);return s.on("value",o),function(e,t,n,r,i,o){Is(e,"transaction on "+t);var s={path:t,update:n,onComplete:r,status:null,order:we(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null};n=Ts(e,t,void 0),s.currentInputSnapshot=n,void 0===(r=s.update(n.val()))?(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot)):(ts("transaction failed: Data returned ",r,s.path),s.status=0,(i=Mo(o=Lo(e.transactionQueueTree_,t))||[]).push(s),Fo(o,i),o=void 0,"object"==typeof r&&null!==r&&O(r,".priority")?(o=A(r,".priority"),f(Ho(o),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):o=(co(e.serverSyncTree_,t)||Wn.EMPTY_NODE).getPriority().val(),i=fs(e),o=Hn(r,o),i=Do(o,n,i),s.currentOutputSnapshotRaw=o,s.currentOutputSnapshotResolved=i,s.currentWriteId=gs(e),s=oo(e.serverSyncTree_,t,i,s.currentWriteId,s.applyLocally),ss(e.eventQueue_,t,s),Ps(e,e.transactionQueueTree_))}(this.repo,this.path,e,(function(e,n,o){e?(i.reject(e),"function"==typeof t&&t(e,n,null)):(o=new Ms(o,new na(r.database,r.path),Nn),i.resolve(new Js(n,o)),"function"==typeof t&&t(null,n,o))}),(function(){s.off("value",o)}),n),i.promise},na.prototype.setPriority=function(e,t){Q("Reference.setPriority",1,2,arguments.length),Jo("Reference.setPriority",this.path),Ko("Reference.setPriority",1,e,!1),U("Reference.setPriority",2,t,!0);var n=new m;return ms(this.repo,Ft(this.path,".priority"),e,null,n.wrapCallback(t)),n.promise},na.prototype.push=function(e,t){Q("Reference.push",0,2,arguments.length),Jo("Reference.push",this.path),Vo("Reference.push",1,e,this.path,!0),U("Reference.push",2,t,!0);var n=ps(this.repo),r=nr(n),i=(n=this.child(r),this.child(r));return e=null!=e?n.set(e,t).then((function(){return i})):Promise.resolve(i),n.then=e.then.bind(e),n.catch=e.then.bind(e,void 0),"function"==typeof t&&e.catch((function(){})),n},na.prototype.onDisconnect=function(){return Jo("Reference.onDisconnect",this.path),new qs(this.repo,this.path)},Object.defineProperty(na.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(na.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(na.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),na);function na(e,t){return Zs.call(this,e,t,new pr,!1)||this}Gs.__referenceConstructor=ta,ea=ta,f(!Wi,"__referenceConstructor has already been defined"),Wi=ea;var ra="FIREBASE_DATABASE_EMULATOR_HOST",ia={},oa=!1;function sa(e,t,n,r){var i=n||e.options.databaseURL;void 0===i&&(e.options.projectId||Te("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ie("Using default host for project ",e.options.projectId),i=e.options.projectId+"-default-rtdb.firebaseio.com");var o,s=As(i,r),a=s.repoInfo;return n=void 0,(n="undefined"!=typeof process?{}[ra]:n)?(o=!0,i="http://"+n+"?ns="+a.namespace,a=(s=As(i,r)).repoInfo):o=!s.repoInfo.secure,t=r&&o?new Be:new je(e,t),ns("Invalid Firebase Database URL",1,s),qt(s.path)||Te("Database URL must point to the root of a Firebase Database (not including a child path)."),t=function(e,t,n){var r=A(ia,t.name);r||(r={},ia[t.name]=r);var i=A(r,e.toURLString());return i&&Te("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new hs(e,oa,t,n),r[e.toURLString()]=i}(a,e,t),new aa(t)}var aa=(Object.defineProperty(ua.prototype,"repo_",{get:function(){return this.instanceStarted_||(ds(this.repoInternal_),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(ua.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new ta(this,xt())),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(ua.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),ua.prototype.useEmulator=function(e,t){var n;this.checkDeleted_("useEmulator"),this.instanceStarted_?Te("Cannot call useEmulator() after instance has already been initialized."):(e=e,t=t,(n=this.repoInternal_).repoInfo_=new Ye(e+":"+t,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),n.repoInfo_.nodeAdmin&&(n.authTokenProvider_=new Be))},ua.prototype.ref=function(e){return this.checkDeleted_("ref"),Q("database.ref",0,1,arguments.length),e instanceof ta?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},ua.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),Q(t,1,1,arguments.length);var n=As(e,this.repo_.repoInfo_.nodeAdmin);return ns(t,1,n),e=n.repoInfo,this.repo_.repoInfo_.isCustomHost()||e.host===this.repo_.repoInfo_.host||Te(t+": Host name does not match the current database: (found "+e.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},ua.prototype.checkDeleted_=function(e){null===this.repoInternal_&&Te("Cannot call "+e+" on a deleted database.")},ua.prototype.goOffline=function(){Q("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),Es(this.repo_)},ua.prototype.goOnline=function(){var e;Q("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),(e=this.repo_).persistentConnection_&&e.persistentConnection_.resume(us)},ua.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},ua);function ua(e){var t=this;this.repoInternal_=e,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return s(t,void 0,void 0,(function(){return a(this,(function(e){var t,n;return this.checkDeleted_("delete"),t=this.repo_,(n=A(ia,t.app.name))&&A(n,t.key)===t||Te("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),Es(t),delete n[t.key],this.repoInternal_=null,this.rootInternal_=null,[2]}))}))}},e instanceof hs||Te("Don't call new Database() directly - please use firebase.database().")}var la=Object.freeze({__proto__:null,forceLongPolling:function(){pt.forceDisallow(),st.forceAllow()},forceWebSockets:function(){st.forceDisallow()},isWebSocketsAvailable:function(){return pt.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){var n;e=e.repo,void 0===(t=t)&&(t=!1),"undefined"!=typeof console&&(e=t?(e.statsListener_||(e.statsListener_=new Pr(e.stats_)),e.statsListener_.get()):e.stats_.get(),n=Object.keys(e).reduce((function(e,t){return Math.max(t.length,e)}),0),De(e,(function(e,t){for(var r=e,i=e.length;i<n+2;i++)r+=" ";console.log(r+t)})))},statsIncrementCounter:function(e,t){t=t,(e=e.repo).stats_.incrementCounter(t),t=t,(e=e.statsReporter_).statsToReport_[t]=!0},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){t=t,(e=e.repo).interceptServerDataCallback_=t},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace;return e=void 0!==(e=e.nodeAdmin)&&e,ct(r),(r=new Y("auth-internal",new J("database-standalone"))).setComponent(new V("auth-internal",(function(){return i}),"PRIVATE")),{instance:sa(t,r,n,e),namespace:o}}});mt=Xt,Xt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Xt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var ha,ca=Object.freeze({__proto__:null,DataConnection:mt,RealTimeConnection:vt,hijackHash:function(e){var t=Xt.prototype.put;return Xt.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Xt.prototype.put=t}},ConnectionTarget:Ye,queryIdentifier:function(e){return e.queryIdentifier()},forceRestClient:function(e){oa=e}}),da=aa.ServerValue;ct((ha=n.default).SDK_VERSION),ha.INTERNAL.registerComponent(new V("database",(function(e,t){return t=t.instanceIdentifier,sa(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),t,void 0)}),"PUBLIC").setServiceProps({Reference:ta,Query:Gs,Database:aa,DataSnapshot:Ms,enableLogging:he,INTERNAL:la,ServerValue:da,TEST_ACCESS:ca}).setMultipleInstances(!0)),ha.registerVersion("@firebase/database","0.9.8")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-database.js - be sure to load firebase-app.js first.")}}(n(59))}}]);
//# sourceMappingURL=c8d50c2c-e514fdea9821261feca3.js.map